<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>快乐虫の地带</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="我的笔记">
<meta property="og:type" content="website">
<meta property="og:title" content="快乐虫の地带">
<meta property="og:url" content="http://happychong.github.io/index.html">
<meta property="og:site_name" content="快乐虫の地带">
<meta property="og:description" content="我的笔记">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="快乐虫の地带">
<meta name="twitter:description" content="我的笔记">
  
    <link rel="alternate" href="/atom.xml" title="快乐虫の地带" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">快乐虫の地带</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://happychong.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="default-2018-1-11-HEXO-hello-world" class="article article-type-default" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/03/29/2018-1-11-HEXO-hello-world/" class="article-date">
  <time datetime="2022-03-29T02:56:39.047Z" itemprop="datePublished">2022-03-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/周边/">周边</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/03/29/2018-1-11-HEXO-hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post-创建项目"><a href="#Create-a-new-post-创建项目" class="headerlink" title="Create a new post 创建项目"></a>Create a new post 创建项目</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server-启动服务"><a href="#Run-server-启动服务" class="headerlink" title="Run server 启动服务"></a>Run server 启动服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files-生成静态文件"><a href="#Generate-static-files-生成静态文件" class="headerlink" title="Generate static files 生成静态文件"></a>Generate static files 生成静态文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites-部署到站点"><a href="#Deploy-to-remote-sites-部署到站点" class="headerlink" title="Deploy to remote sites 部署到站点"></a>Deploy to remote sites 部署到站点</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://happychong.github.io/2022/03/29/2018-1-11-HEXO-hello-world/" data-id="cl1dl9zbg000accnuody41ulz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/">hexo</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="default-2020-3-20-webpack原理" class="article article-type-default" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/03/29/2020-3-20-webpack原理/" class="article-date">
  <time datetime="2022-03-29T02:49:29.888Z" itemprop="datePublished">2022-03-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/周边/">周边</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/03/29/2020-3-20-webpack原理/">webpack 原理与实现</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="一：预备知识点-—-提前了解这些知识，接下来会用到"><a href="#一：预备知识点-—-提前了解这些知识，接下来会用到" class="headerlink" title="一：预备知识点 — 提前了解这些知识，接下来会用到"></a>一：预备知识点 — 提前了解这些知识，接下来会用到</h2><h3 id="1：Symbol-toStringTag-—-自定义类型标签"><a href="#1：Symbol-toStringTag-—-自定义类型标签" class="headerlink" title="1：Symbol.toStringTag — 自定义类型标签"></a>1：Symbol.toStringTag — 自定义类型标签</h3><p>Symbol.toStringTag 是一个内置 symbol，它通常作为对象的属性键使用，对应的属性值应该为字符串类型，这个字符串用来表示该对象的自定义类型标签，通常只有内置的 Object.prototype.toString() 方法会去读取这个标签并把它包含在自己的返回值里。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Symbol.toStringTag 自定义类型标签 Module</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(&#123;<span class="attr">name</span>: <span class="string">'webpack'</span>&#125;)); <span class="comment">// [object Object]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])); <span class="comment">// [object Array]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(<span class="number">10</span>)); <span class="comment">// [object Number]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(<span class="literal">true</span>)); <span class="comment">// [object Boolean]</span></span><br><span class="line"><span class="comment">// Object.prototype.toString.call 方法返回 类同 [object Object] 这样的字符串</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Symbol.toStringTag 可以设置对象的返回类型，如下，把 useExports 的 类型改为 Module</span></span><br><span class="line"><span class="keyword">let</span> useExports = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(useExports, <span class="built_in">Symbol</span>.toStringTag, &#123;<span class="attr">value</span>: <span class="string">'Module'</span>&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(useExports)); <span class="comment">// [object Module]</span></span><br></pre></td></tr></table></figure>

<h3 id="2：Object-create-null"><a href="#2：Object-create-null" class="headerlink" title="2：Object.create(null)"></a>2：Object.create(null)</h3><p>Object.create(null) 可以得到一个非常干净的对象，不会继承 Object 上的任何属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line"><span class="built_in">console</span>.log(obj); <span class="comment">// [Object: null prototype] &#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 原理 - new 一个对象，使这个对象的原型链指向create的参数</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">Object</span>.create) &#123;</span><br><span class="line">  <span class="built_in">Object</span>.create = <span class="function"><span class="keyword">function</span> (<span class="params">proto</span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">    F.prototype = proto;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> F();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3：getter"><a href="#3：getter" class="headerlink" title="3：getter"></a>3：getter</h3><p>Object.defineProperty() 方法会直接在一个对象上定义一个新属性，或者修改一个对象的现有属性， 并返回这个对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 语法</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, prop, descriptor)</span><br><span class="line"><span class="comment">// obj：要在其上定义属性的对象。</span></span><br><span class="line"><span class="comment">// prop：要定义或修改的属性的名称。</span></span><br><span class="line"><span class="comment">// descriptor：将被定义或修改的属性描述符。</span></span><br><span class="line"><span class="comment">// 返回值：被传递给函数的对象。</span></span><br></pre></td></tr></table></figure>

<p>基础语法如上，更多内容请自行百度 Object.defineProperty</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 示例</span></span><br><span class="line"><span class="keyword">let</span> ageValue;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line"><span class="comment">// obj.age = ageValue; // 老写法改为下面的 defineProperty 方式</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'age'</span>, &#123;</span><br><span class="line">  <span class="comment">// value: 10, // value: 10 的设置方式与get方法的设置方式只能2选1</span></span><br><span class="line">  <span class="keyword">get</span>()&#123;</span><br><span class="line">    <span class="keyword">return</span> ageValue;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">set</span>(newValue)&#123;</span><br><span class="line">    ageValue = newValue;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">obj.age = <span class="number">3</span>; <span class="comment">// 走 set 方法</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.age); <span class="comment">// 走 get 方法</span></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="built_in">console</span>.log(ageValue);</span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line">ageValue = <span class="number">4</span></span><br><span class="line"><span class="built_in">console</span>.log(ageValue);</span><br><span class="line"><span class="comment">// 4</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.age);</span><br><span class="line"><span class="comment">// 4</span></span><br></pre></td></tr></table></figure>

<h2 id="二：webpack-源代码"><a href="#二：webpack-源代码" class="headerlink" title="二：webpack 源代码"></a>二：webpack 源代码</h2><h3 id="提前准备webpack项目"><a href="#提前准备webpack项目" class="headerlink" title="提前准备webpack项目"></a>提前准备webpack项目</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  devtool: <span class="string">'none'</span>,</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">  <span class="comment">// index.js 文件内容在原理中展示，因为同步和异步代码不同</span></span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: []</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line"></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/title.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="string">'title'</span>;</span><br></pre></td></tr></table></figure>

<h3 id="同步打包原理"><a href="#同步打包原理" class="headerlink" title="同步打包原理"></a>同步打包原理</h3><h4 id="提前准备文件"><a href="#提前准备文件" class="headerlink" title="提前准备文件"></a>提前准备文件</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步加载</span></span><br><span class="line"><span class="keyword">let</span> title = <span class="built_in">require</span>(<span class="string">'./title.js'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(title);</span><br></pre></td></tr></table></figure>

<h4 id="打包原理"><a href="#打包原理" class="headerlink" title="打包原理"></a>打包原理</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自执行函数 参数为应用到的模块</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">modules</span>)</span>&#123; <span class="comment">// webpackBootstrap : 启动函数</span></span><br><span class="line">  <span class="keyword">var</span> installedModules = &#123;&#125;; <span class="comment">// The module cache ： 模块缓存</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123; <span class="comment">// The require function ：webpack 实现的浏览器的 require 方法</span></span><br><span class="line">    <span class="comment">// Check if module is in cache ： 检查模块是否在缓存中，有的话直接返回模块的exports</span></span><br><span class="line">    <span class="keyword">if</span> (installedModules[moduleId]) &#123;</span><br><span class="line">      <span class="keyword">return</span> installedModules[moduleId].exports;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Create a new module (and put it into the cache)：创建一个新的模块 （并且放入缓存中）</span></span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">module</span> = installedModules[moduleId] = &#123;</span><br><span class="line">      i: moduleId, <span class="comment">// i - index - 模块id</span></span><br><span class="line">      l: <span class="literal">false</span>, <span class="comment">// l - loaded - 模块是否加载完成</span></span><br><span class="line">      exports: &#123;&#125; <span class="comment">// 模块的导出对象</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// Execute the module function ： 执行模块的方法</span></span><br><span class="line">    modules[moduleId].call(<span class="built_in">module</span>.exports, <span class="built_in">module</span>, <span class="built_in">module</span>.exports, __webpack_require__);</span><br><span class="line">    <span class="comment">// Flag the module as loaded ： loaded设置为true</span></span><br><span class="line">    <span class="built_in">module</span>.l = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// Return the exports of the module ： 返回模块的导出对象(module.exports)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Load entry module and return exports : 加载入口模块并返回道处对象 __webpack_require__.s = 入口模块Id</span></span><br><span class="line">  <span class="keyword">return</span> __webpack_require__(<span class="string">'./src/index.js'</span>);</span><br><span class="line">&#125;)(&#123;</span><br><span class="line">  <span class="string">'./src/index.js'</span>: (<span class="function"><span class="keyword">function</span> (<span class="params">module, exports, __webpack_require__</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> title = __webpack_require__(<span class="string">'./src/title.js'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(title);</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="string">'./src/title.js'</span>: (<span class="function"><span class="keyword">function</span> (<span class="params">module, exports, __webpack_require__</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">module</span>.exports = <span class="string">'title'</span>;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="异步打包原理：import-方式"><a href="#异步打包原理：import-方式" class="headerlink" title="异步打包原理：import()方式"></a>异步打包原理：import()方式</h3><h4 id="提前准备文件-1"><a href="#提前准备文件-1" class="headerlink" title="提前准备文件"></a>提前准备文件</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> button = <span class="built_in">document</span>.createElement(<span class="string">'button'</span>);</span><br><span class="line">button.innerHTML = <span class="string">'点我异步加载'</span>;</span><br><span class="line">button.addEventListener(<span class="string">'click'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">import</span>(<span class="comment">/*webpackChunkName: 'title'*/</span><span class="string">'./title.js'</span>).then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(result.default);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(button);</span><br></pre></td></tr></table></figure>

<h4 id="打包原理-1"><a href="#打包原理-1" class="headerlink" title="打包原理"></a>打包原理</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">modules</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> installedModules = &#123;&#125;; <span class="comment">// 模块缓存</span></span><br><span class="line">	<span class="keyword">var</span> installChunks = &#123;</span><br><span class="line">		main: <span class="number">0</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// 1：标记 installChunks[x] 为0表示加载成功</span></span><br><span class="line">	<span class="comment">// 2：modules 中加入新加载的模块，使新的模块可以被require</span></span><br><span class="line">	<span class="comment">// 2：执行异步加载的resolve方法</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">webpackJsonpCallback</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">		<span class="comment">// data 格式如下</span></span><br><span class="line">		<span class="comment">// [["title"],&#123;</span></span><br><span class="line">		<span class="comment">// 	"./src/title.js":</span></span><br><span class="line">		<span class="comment">// 	(function(module, exports) &#123;</span></span><br><span class="line">		<span class="comment">// 		module.exports = 'title';</span></span><br><span class="line">		<span class="comment">// 	&#125;)</span></span><br><span class="line">		<span class="comment">// &#125;]</span></span><br><span class="line">		<span class="keyword">let</span> chunkIds = data[<span class="number">0</span>]; <span class="comment">// ["title"]</span></span><br><span class="line">		<span class="keyword">let</span> moreModules = data[<span class="number">1</span>]; <span class="comment">// &#123;"./src/title.js": (fn)&#125;</span></span><br><span class="line">		<span class="keyword">let</span> resolves = [];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; chunkIds.length; i++) &#123;</span><br><span class="line">			<span class="keyword">let</span> chunkId = chunkIds[i];</span><br><span class="line">			resolves.push(installChunks[chunkId][<span class="number">0</span>]);</span><br><span class="line">			installChunks[chunkId] = <span class="number">0</span>; <span class="comment">// 0:加载成功  原本是数组 这里重置为0</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 模块中（modules）加入新加载的模块 ，加入后就可以require（__webpack_require__）了</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">let</span> moduleId <span class="keyword">in</span> moreModules) &#123;</span><br><span class="line">			modules[moduleId] = moreModules[moduleId];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span>(resolves.length) &#123;</span><br><span class="line">			resolves.shift()(); <span class="comment">// 取出第一个元素，并执行</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// if (parentJsonFunction) &#123;</span></span><br><span class="line">		<span class="comment">// 	parentJsonFunction(data);</span></span><br><span class="line">		<span class="comment">// &#125;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 加载模块 - 同步</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123; <span class="comment">// webpack 实现的浏览器的 require 方法</span></span><br><span class="line">    <span class="comment">// 检查模块是否在缓存中，有的话直接返回模块的exports</span></span><br><span class="line">    <span class="keyword">if</span> (installedModules[moduleId]) &#123;</span><br><span class="line">      <span class="keyword">return</span> installedModules[moduleId].exports;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 创建一个新的模块 （并且放入缓存中）</span></span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">module</span> = installedModules[moduleId] = &#123;</span><br><span class="line">      i: moduleId, <span class="comment">// i - index - 模块id</span></span><br><span class="line">      l: <span class="literal">false</span>, <span class="comment">// l - loaded - 模块是否加载完成</span></span><br><span class="line">      exports: &#123;&#125; <span class="comment">// 模块的导出对象</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 执行模块的方法</span></span><br><span class="line">    modules[moduleId].call(<span class="built_in">module</span>.exports, <span class="built_in">module</span>, <span class="built_in">module</span>.exports, __webpack_require__);</span><br><span class="line">    <span class="comment">// loaded设置为true</span></span><br><span class="line">    <span class="built_in">module</span>.l = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// 返回模块的导出对象(module.exports)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 把模块的exports抛出为下一步then的参数</span></span><br><span class="line">	__webpack_require__.t = <span class="function"><span class="keyword">function</span> (<span class="params">value, mode</span>) </span>&#123;</span><br><span class="line">		<span class="comment">// value="./src/title.js"     mode+7</span></span><br><span class="line">		value = __webpack_require__(value); <span class="comment">// module.exports = 'title';</span></span><br><span class="line">		<span class="keyword">let</span> ns = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">		<span class="built_in">Object</span>.defineProperty(ns, <span class="string">'__esModule'</span>, &#123; <span class="attr">value</span>: <span class="literal">true</span> &#125;); <span class="comment">// 表示这是一个es6modules</span></span><br><span class="line">		<span class="built_in">Object</span>.defineProperty(ns, <span class="string">'default'</span>, &#123; value &#125;);</span><br><span class="line">		<span class="keyword">return</span> ns; <span class="comment">// &#123;__esModule: true, default: 'title'&#125;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// .e 加载模块 - 异步jsonp</span></span><br><span class="line">	__webpack_require__.e = <span class="function"><span class="keyword">function</span> (<span class="params">chunkId</span>) </span>&#123; <span class="comment">// title</span></span><br><span class="line">		<span class="comment">// let promises = []; // 声明一个promise</span></span><br><span class="line">		<span class="keyword">var</span> installChunkData = installChunks[chunkId]; <span class="comment">// 取老的代码块数据</span></span><br><span class="line">		<span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">			<span class="comment">// 如果调用了resolve方法，此promise会变成成功态</span></span><br><span class="line">			installChunkData = installChunks[chunkId] = [resolve, reject];</span><br><span class="line">		&#125;);</span><br><span class="line">		installChunkData[<span class="number">2</span>] = promise; <span class="comment">// installChunkData = [resolve, reject, promise]</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>); <span class="comment">// 创建一个脚本标签</span></span><br><span class="line">		script.src = chunkId + <span class="string">'.bundle.js'</span>; <span class="comment">// title.bundle.js</span></span><br><span class="line">		<span class="built_in">document</span>.head.appendChild(script); <span class="comment">// jsonP原理，script标签加到页面里，立刻会请求服务器的文件，执行脚本</span></span><br><span class="line">		<span class="keyword">return</span> promise;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// .e 方法加载的脚本立即执行，执行时候执行了window['webpackJsonp'].push方法，下面代码重写了push方法，指向了webpackJsonpCallback</span></span><br><span class="line">	<span class="keyword">var</span> jsonArray = (<span class="built_in">window</span>[<span class="string">'webpackJsonp'</span>] = <span class="built_in">window</span>[<span class="string">'webpackJsonp'</span>] || []); <span class="comment">// jsonArray = window['webpackJsonp'] || [];</span></span><br><span class="line">	<span class="keyword">var</span> oldJsonpFunction = jsonArray.push.bind(jsonArray); <span class="comment">// oldJsonpFunction = jsonArray原有的push方法</span></span><br><span class="line">	jsonArray.push = webpackJsonpCallback; 	<span class="comment">// 重写jsonArr的push方法</span></span><br><span class="line">	<span class="keyword">var</span> parentJsonFunction = oldJsonpFunction; <span class="comment">// </span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 加载入口模块并返回道处对象 __webpack_require__.s = 入口模块Id</span></span><br><span class="line">  <span class="keyword">return</span> __webpack_require__(<span class="string">'./src/index.js'</span>);</span><br><span class="line">&#125;)(&#123;</span><br><span class="line">	<span class="string">'./src/index.js'</span>: (<span class="function"><span class="keyword">function</span>(<span class="params">module, exports, __webpack_require__</span>) </span>&#123;</span><br><span class="line">		<span class="comment">// 同步加载</span></span><br><span class="line">		<span class="comment">// let title = require('./title.js');</span></span><br><span class="line">		<span class="comment">// console.log(title);</span></span><br><span class="line">	</span><br><span class="line">		<span class="comment">// 异步加载</span></span><br><span class="line">		<span class="keyword">let</span> button = <span class="built_in">document</span>.createElement(<span class="string">'button'</span>);</span><br><span class="line">		button.innerHTML = <span class="string">'点我异步加载'</span>;</span><br><span class="line">		button.addEventListener(<span class="string">'click'</span>, () =&gt; &#123;</span><br><span class="line">			__webpack_require__.e(<span class="comment">/*! import() | title */</span> <span class="string">"title"</span>)</span><br><span class="line">			.then(__webpack_require__.t.bind(<span class="literal">null</span>, <span class="comment">/*! ./title.js */</span> <span class="string">"./src/title.js"</span>, <span class="number">7</span>))</span><br><span class="line">			.then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">				<span class="built_in">console</span>.log(result.default);</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;)</span><br><span class="line">		<span class="built_in">document</span>.body.appendChild(button);</span><br><span class="line">	</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://happychong.github.io/2022/03/29/2020-3-20-webpack原理/" data-id="cl1dl9ze9002hccnumexcaxif" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack/">webpack</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="default-2020-3-25-webpack-loader原理" class="article article-type-default" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/03/29/2020-3-25-webpack-loader原理/" class="article-date">
  <time datetime="2022-03-29T02:49:29.888Z" itemprop="datePublished">2022-03-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/周边/">周边</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/03/29/2020-3-25-webpack-loader原理/">webpack - loader 原理与实现</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="提前准备webpack项目"><a href="#提前准备webpack项目" class="headerlink" title="提前准备webpack项目"></a>提前准备webpack项目</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"10.mywebpack"</span>,</span><br><span class="line">  <span class="string">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="string">"description"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="string">"main"</span>: <span class="string">"index.js"</span>,</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"webpack"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"author"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="string">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"@babel/core"</span>: <span class="string">"^7.9.0"</span>,</span><br><span class="line">    <span class="string">"@babel/preset-env"</span>: <span class="string">"^7.9.0"</span>,</span><br><span class="line">    <span class="string">"webpack"</span>: <span class="string">"^4.42.1"</span>,</span><br><span class="line">    <span class="string">"webpack-cli"</span>: <span class="string">"^3.3.11"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  devtool: <span class="string">'none'</span>,</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  resolveLoader: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="comment">// 配置 module -&gt; rules -&gt; babel-loader 路径</span></span><br><span class="line">      <span class="string">'babel-loader'</span>: path.resolve(__dirname, <span class="string">'loaders/babel-loader.js'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 配置 module -&gt; rules 下配置的loader都先去当前路径的loaders目录下查找，再去node_modules下查找</span></span><br><span class="line">    modules: [path.resolve(__dirname, <span class="string">'loaders'</span>), <span class="string">'node_modules'</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        use: [<span class="string">'babel-loader'</span>] <span class="comment">// 这样的写法会到node_modules下找babel-loader</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line"></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">let</span> title = <span class="built_in">require</span>(<span class="string">'./title'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(title);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/title.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="string">'title'</span>;</span><br></pre></td></tr></table></figure>

<h2 id="最简单的打包原理——最简单的-babel-loader"><a href="#最简单的打包原理——最简单的-babel-loader" class="headerlink" title="最简单的打包原理——最简单的 babel-loader"></a>最简单的打包原理——最简单的 babel-loader</h2><p>loader是个函数，参数接受一些代码内容，经过一些转换返回新的内容，loader的执行顺序是倒序执行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// loaders/babel-loader.js</span></span><br><span class="line"><span class="keyword">const</span> babel = <span class="built_in">require</span>(<span class="string">'@babel/core'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loader</span>(<span class="params">source, sourceMap</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// source - 输入的内容 要串换的内容</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'this is my loader ! ~~~~~~~~~~~~'</span>);</span><br><span class="line">  <span class="comment">// console.log运行的时候，这里会被打印出2次，因为有2个文件啊，index.js &amp; title.js</span></span><br><span class="line">  <span class="keyword">const</span> options = &#123;</span><br><span class="line">    presets: [], <span class="comment">// babel预设 '@bebal/preset-env'</span></span><br><span class="line">    inputSourceMap: sourceMap, <span class="comment">// 输入的 源映射</span></span><br><span class="line">    sourceMaps: <span class="literal">true</span>, <span class="comment">// 输出 要 sourceMaps</span></span><br><span class="line">    <span class="comment">// this.request = loader1!loader2!loader3!indexedDB.css</span></span><br><span class="line">    filename: <span class="keyword">this</span>.request.split(<span class="string">'!'</span>).pop() <span class="comment">// 指定文件名</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// code : 转译后代码  map：sourcemap   ast：抽象语法树</span></span><br><span class="line">  <span class="keyword">let</span> &#123;code, map, ast&#125; = babel.transform(source, options);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.callback(<span class="literal">null</span>, code, map, ast)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = loader;</span><br></pre></td></tr></table></figure>

<p>现在命令行执行 npm run build ，就会看到dist目录下有用了我们自己写的loader（loaders/babel-loader.js ）的 bundle.js 文件了</p>
<h2 id="loader-的加载顺序"><a href="#loader-的加载顺序" class="headerlink" title="loader 的加载顺序"></a>loader 的加载顺序</h2><h3 id="pitch-与-normal-的执行顺序"><a href="#pitch-与-normal-的执行顺序" class="headerlink" title="pitch 与 normal 的执行顺序"></a>pitch 与 normal 的执行顺序</h3><p>假如我们现在对.js类型的文件配置了3个loader [‘loader1’, ‘loader2’, ‘loader3’],那么现在loader的执行顺序应该是 源代码（ex: index.js） -&gt; loader3 -&gt; loader2 -&gt; loader1，实践代码如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      <span class="comment">// pitch</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        use: [<span class="string">'patch-loader1'</span>, <span class="string">'patch-loader2'</span>, <span class="string">'patch-loader3'</span>]</span><br><span class="line">			&#125;</span><br><span class="line">		]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// loaders/patch-loader1.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loader</span>(<span class="params">source, sourceMap</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'patch-loader1111'</span>);</span><br><span class="line">  <span class="keyword">return</span> source + <span class="string">'///patch-loader1111///'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = loader;</span><br><span class="line"></span><br><span class="line"><span class="comment">// loaders/patch-loader2.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loader</span>(<span class="params">source, sourceMap</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'patch-loader222'</span>);</span><br><span class="line">  <span class="keyword">return</span> source + <span class="string">'///patch-loader222///'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = loader;</span><br><span class="line"></span><br><span class="line"><span class="comment">// loaders/patch-loader3.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loader</span>(<span class="params">source, sourceMap</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'patch-loader333'</span>);</span><br><span class="line">  <span class="keyword">return</span> source + <span class="string">'///patch-loader333///'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = loader;</span><br></pre></td></tr></table></figure>

<p>命令行运行 npm run build 可以看到 loader 的执行顺序为 3 - 2 - 1，，dist下打包的bundle.js中也可以看到执行顺序，但是其实这里看到的执行顺序是不完全的，实际上每个loader有2个方法，以上的执行方法叫做 normal 方法，另外还有一个方法，就叫做 pitch，pitch 方法是可有可无的，如果有 pitch 方法的话，会先顺序执行每个 loader 的 pitch 方法，然后再倒序执行 loader 的 normal 方法，但是如果某个 loader 有 pitch 方法，并且 pitch 方法有返回值，那么就会跳过剩下的其他方法，直接执行上一个loader的一个 normal 方法，并且这个方法的source参数就是pitch方法的返回值。</p>
<p>完整的 loader 执行顺序如下图</p>
<p><img src="/images/webpack-loader.png" alt="webpack-loader-执行顺序"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 我们可以修改之前的代码验证一下</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// patch-loader1.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loader</span>(<span class="params">source, sourceMap</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'normal-loader1111'</span>);</span><br><span class="line">  <span class="keyword">return</span> source + <span class="string">'///normal-loader1111///'</span>;</span><br><span class="line">&#125;</span><br><span class="line">loader.pitch = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'pitch1'</span>);</span><br><span class="line">  <span class="comment">// return '1'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = loader;</span><br><span class="line"></span><br><span class="line"><span class="comment">// patch-loader2.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loader</span>(<span class="params">source, sourceMap</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'normal-loader222'</span>);</span><br><span class="line">  <span class="keyword">return</span> source + <span class="string">'///normal-loader222///'</span>;</span><br><span class="line">&#125;</span><br><span class="line">loader.pitch = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'pitch2'</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'loader2 --- pitch2'</span></span><br><span class="line">  <span class="comment">// 这里返回的值，会作为下一个normal方法的source参数传入</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = loader;</span><br><span class="line"></span><br><span class="line"><span class="comment">// patch-loader3.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loader</span>(<span class="params">source, sourceMap</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// source - 输入的内容 要串换的内容</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'normal-loader333'</span>);</span><br><span class="line">  <span class="keyword">return</span> source + <span class="string">'///normal-loader333///'</span>;</span><br><span class="line">&#125;</span><br><span class="line">loader.pitch = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'pitch3'</span>);</span><br><span class="line">  <span class="comment">// return 'loader3 --- pitch3'</span></span><br><span class="line">  <span class="comment">// 如果loader2的pitch方法有返回值，那这个loader3的方法都不执行了</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = loader;</span><br></pre></td></tr></table></figure>

<p>命令行运行 npm run build 可以看到 loader 的执行顺序为 loader1(pitch) -&gt; loader2(pitch) -&gt; loader1(normal)</p>
<h3 id="不同类型-loader-的执行顺序"><a href="#不同类型-loader-的执行顺序" class="headerlink" title="不同类型 loader 的执行顺序"></a>不同类型 loader 的执行顺序</h3><p>对单文件打包的方式的loader被称为行内（inline）loader；对于rules中的loader，webpack还定义了一个属性 enforce，可取值有 pre（为pre loader）、post（为post loader），如果没有值则为（normal loader）。所以loader在webpack中有4种:normal，inline，pre，post。</p>
<p>loader的叠加顺序 = post(后置) + inline(内联) + normal(正常) + pre(前置)</p>
<h2 id="loaders-configuration——特殊配置"><a href="#loaders-configuration——特殊配置" class="headerlink" title="loaders/#configuration——特殊配置"></a>loaders/#configuration——特殊配置</h2><ul>
<li>!   前缀禁用配置文件中的普通loader，比如：require(“!raw!./script.coffee”)</li>
<li>!!  前缀禁用配置文件中所有的loader，比如：require(“!!raw!./script.coffee”)</li>
<li>-!  禁用pre loader和普通loader，但是不包括post loader，比如：require(“!!raw!./script.coffee”)</li>
</ul>
<p>关于loader的禁用，webpack官方的建议是：除非从另一个loader处理生成的，一般不建议主动使用，以下下是使用场景</p>
<ul>
<li>pre loader 配置：图片压缩</li>
<li>普通loader 配置：coffee-script转换</li>
<li>inline loader 配置：bundle loader</li>
<li>post loader 配置： 代码覆盖率工具</li>
</ul>
<h2 id="webpack-的-loader-runner-库的原理"><a href="#webpack-的-loader-runner-库的原理" class="headerlink" title="webpack 的 loader-runner 库的原理"></a>webpack 的 loader-runner 库的原理</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// loaders/myLoader-runner-getPath.js</span></span><br><span class="line"><span class="comment">// 此文件功能：按loader的类别及loaders/#configuration配置获得要执行的loader绝对路径的数组</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// loader 的4种类型：inline normal pre post</span></span><br><span class="line"><span class="comment">// ex：eslint 代码风格检查 一般用于前置</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="comment">// 正常情况下module的查找路径（变量模拟）</span></span><br><span class="line"><span class="keyword">let</span> nodeModules = path.resolve(__dirname, <span class="string">'node_modules'</span>);</span><br><span class="line"><span class="comment">// 模拟需要加载的文件 - 行内（inline）loader </span></span><br><span class="line"><span class="comment">// 业务代码示例：import a from ''!inline-loader1!inline-loader2!./style.css'' 或者 require('!inline-loader1!inline-loader2!./style.css'u)</span></span><br><span class="line"><span class="keyword">let</span> request = <span class="string">'!inline-loader1!inline-loader2!./style.css'</span>;</span><br><span class="line"><span class="comment">// 模拟webpack loader 的配置</span></span><br><span class="line"><span class="keyword">let</span> rules = [</span><br><span class="line">  <span class="comment">// enforce ：配置loader类型-手动配置loader执行顺序</span></span><br><span class="line">  &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">enforce</span>: <span class="string">'pre'</span>, <span class="attr">use</span>:[<span class="string">'pre-loader1'</span>, <span class="string">'pre-loader2'</span>] &#125;, <span class="comment">// pre 前置的</span></span><br><span class="line">  &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>:[<span class="string">'normal-loader1'</span>, <span class="string">'normal-loader2'</span>] &#125;, <span class="comment">// normal 普通的</span></span><br><span class="line">  &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">enforce</span>: <span class="string">'post'</span>, <span class="attr">use</span>:[<span class="string">'post-loader1'</span>, <span class="string">'post-loader2'</span>] &#125; <span class="comment">// post 后置</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以上模拟数据结束，一下开始原理部分</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Fn：把路径变为绝对路径</span></span><br><span class="line"><span class="keyword">var</span> resolveLoader = <span class="function"><span class="params">loader</span> =&gt;</span> path.resolve(nodeModules, loader + <span class="string">'.js'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// loaders/#configuration——特殊配置 相关</span></span><br><span class="line"><span class="comment">// 不要前置&amp;普通的loader，只剩下inline&amp;post</span></span><br><span class="line"><span class="keyword">const</span> noPreAutoLoaders = request.startsWith(<span class="string">'-!'</span>);</span><br><span class="line"><span class="comment">// 不要普通的loader</span></span><br><span class="line"><span class="keyword">const</span> noAutoLoaders = noPreAutoLoaders || request.startsWith(<span class="string">'!'</span>);</span><br><span class="line"><span class="comment">// 不要pre&amp;post&amp;auto，只剩下inline了</span></span><br><span class="line"><span class="keyword">const</span> noPrePostAutoLoaders = request.startsWith(<span class="string">'!!'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> inlineLoaders = request.replace(<span class="regexp">/^-?!+/</span>, <span class="string">''</span>).replace(<span class="regexp">/^!!+/g</span>, <span class="string">'!'</span>).split(<span class="string">'!'</span>); <span class="comment">// ["inline-loader1", "inline-loader2", "./style.css"]</span></span><br><span class="line"><span class="comment">// 加载的资源</span></span><br><span class="line"><span class="keyword">let</span> resource = inlineLoaders.pop(); <span class="comment">// "./style.css"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> preLoaders = [];</span><br><span class="line"><span class="keyword">let</span> postLoaders = [];</span><br><span class="line"><span class="keyword">let</span> normalLoaders = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; rules.length; i++) &#123;</span><br><span class="line">  <span class="keyword">let</span> rule = rules[i];</span><br><span class="line">  <span class="keyword">if</span> (rule.test.test(resource)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (rule.enforce === <span class="string">'pre'</span>) &#123;</span><br><span class="line">      preLoaders.push(...rule.use);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (rule.enforce === <span class="string">'post'</span>) &#123;</span><br><span class="line">      postLoaders.push(...rule.use);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      normalLoaders.push(...rule.use);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> loaders = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (noPrePostAutoLoaders) &#123;</span><br><span class="line">  loaders = [...inlineLoaders];</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (noPreAutoLoaders) &#123;</span><br><span class="line">  loaders = [...postLoaders, ...inlineLoaders];</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (noAutoLoaders) &#123;</span><br><span class="line">  loaders = [...postLoaders, ...inlineLoaders, ...preLoaders];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  loaders = [...postLoaders, ...inlineLoaders, ...normalLoaders, ...preLoaders];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 把模块名转变成绝对路径</span></span><br><span class="line">loaders = loaders.map(<span class="function"><span class="params">loader</span> =&gt;</span> resolveLoader(loader));</span><br><span class="line"><span class="built_in">console</span>.log(loaders);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// loaders/myLoader-runner-run.js</span></span><br><span class="line"><span class="comment">// 此文件功能：按顺序执行loader的pitch和normal</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="comment">// 把loader变成对象</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createLoaderObject</span>(<span class="params">loader</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> loaderObj = &#123;<span class="attr">data</span>: &#123;&#125;&#125;;</span><br><span class="line">  loaderObj.request = loader;</span><br><span class="line">  loaderObj.normal = <span class="built_in">require</span>(loader);</span><br><span class="line">  loaderObj.pitch = loaderObj.normal.pitch;</span><br><span class="line">  <span class="keyword">return</span> loaderObj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">runLoaders</span>(<span class="params">options, callback</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 设置loader函数中的this对象</span></span><br><span class="line">  <span class="keyword">let</span> loadercontext= &#123;</span><br><span class="line">    loaderIndex: <span class="number">0</span>, <span class="comment">// 当前索引</span></span><br><span class="line">    readResource: fs, <span class="comment">// 读文件的模块</span></span><br><span class="line">    resource: options.resource, <span class="comment">// 要加载的资源 (index.js)</span></span><br><span class="line">    loaders: options.loaders <span class="comment">// [loader1, loader2, loader3] pathStr</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">let</span> loaders = options.loaders;</span><br><span class="line">  <span class="comment">// loaders 路径Str -&gt; 有paitch， normal，request属性的对象</span></span><br><span class="line">  loadercontext.loaders = loaders.map(<span class="function"><span class="params">loader</span> =&gt;</span> createLoaderObject(loader)); <span class="comment">// [&#123;normal, pitch&#125;, &#123;normal, pitch&#125;]</span></span><br><span class="line">  iteratePitchLoader(loadercontext, callback);</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">processResource</span> (<span class="params">loadercontext, callback</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 读源文件</span></span><br><span class="line">    <span class="keyword">let</span> buffer = loadercontext.readResource.readFileSync(loadercontext.resource, <span class="string">'utf8'</span>);</span><br><span class="line">    iterateNormalLoader(loadercontext, buffer, callback);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">iterateNormalLoader</span>(<span class="params">loadercontext, code, callback</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 遍历loaders 的 normal 方法</span></span><br><span class="line">    <span class="keyword">if</span> (loadercontext.loaderIndex &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> callback(<span class="literal">null</span>, code);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> curLoaderObj = loadercontext.loaders[loadercontext.loaderIndex];</span><br><span class="line">    <span class="keyword">let</span> normalFn = curLoaderObj.normal;</span><br><span class="line">    <span class="keyword">let</span> result = normalFn.call(loadercontext, code);</span><br><span class="line">    loadercontext.loaderIndex--;</span><br><span class="line">    iterateNormalLoader(loadercontext, result, callback);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">iteratePitchLoader</span>(<span class="params">loadercontext, callback</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 遍历pitch方法</span></span><br><span class="line">    <span class="keyword">if</span> (loadercontext.loaderIndex &gt;= loadercontext.loaders.length) &#123;</span><br><span class="line">      <span class="comment">// pitch 方法执行完了，读文件资源，翻转执行normal方法</span></span><br><span class="line">      loadercontext.loaderIndex--;</span><br><span class="line">      <span class="keyword">return</span> processResource(loadercontext, callback);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> curLoaderObj = loadercontext.loaders[loadercontext.loaderIndex];</span><br><span class="line">    <span class="keyword">let</span> pitchFn = curLoaderObj.pitch;</span><br><span class="line">    <span class="keyword">if</span> (!pitchFn) &#123;</span><br><span class="line">      <span class="comment">// 没有pitch函数，下一个pitch方法</span></span><br><span class="line">      loadercontext.loaderIndex++;</span><br><span class="line">      <span class="keyword">return</span> iteratePitchLoader(loadercontext, callback);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> result = pitchFn.apply(loadercontext);</span><br><span class="line">    <span class="comment">// 有pitch方法</span></span><br><span class="line">    <span class="keyword">if</span> (result) &#123;</span><br><span class="line">      <span class="comment">// pitch方法有返回值，要返回上一个loader的normal，且pitch的返回值作为normal方法的第一个参数，没有上一个loader的话，直接返回pitch的值</span></span><br><span class="line">      loadercontext.loaderIndex--;</span><br><span class="line">      iterateNormalLoader(loadercontext, result, callback);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// pitch方法没有返回值 下一个pitch</span></span><br><span class="line">      loadercontext.loaderIndex++;</span><br><span class="line">      iteratePitchLoader(loadercontext, callback);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以上原理部分，以下是原理的方法调用</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> entry = <span class="string">'../src/index.js'</span>;</span><br><span class="line"><span class="keyword">let</span> options = &#123;</span><br><span class="line">  resource: path.resolve(__dirname, entry),</span><br><span class="line">  loaders: [ <span class="comment">// 这里的数据实际应该是 myLoader-runner-getPath.js 中获取到的loaders</span></span><br><span class="line">    path.resolve(__dirname, <span class="string">'patch-loader1.js'</span>),</span><br><span class="line">    path.resolve(__dirname, <span class="string">'patch-loader2.js'</span>),</span><br><span class="line">    path.resolve(__dirname, <span class="string">'patch-loader3.js'</span>)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">runLoaders(options, (err, result) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.error(<span class="string">'执行完毕'</span>);</span><br><span class="line">  <span class="built_in">console</span>.error(result);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><a href="https://github.com/happychong/2019-zhufeng/tree/master/10.myWebpack/3-webpack-loader" target="_blank" rel="noopener">webpack原理代码地址点击这里</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://happychong.github.io/2022/03/29/2020-3-25-webpack-loader原理/" data-id="cl1dl9zec002kccnusyo0hyx6" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/loader/">loader</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack/">webpack</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="default-typescript" class="article article-type-default" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/08/05/typescript/" class="article-date">
  <time datetime="2021-08-04T16:00:00.000Z" itemprop="datePublished">2021-08-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/周边/">周边</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/05/typescript/">typescript</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id><a href="#" class="headerlink" title></a></h1><h2 id="1-typescript-是个啥？"><a href="#1-typescript-是个啥？" class="headerlink" title="1.typescript 是个啥？"></a>1.typescript 是个啥？</h2><ul>
<li>官方：TypeScript是JavaScript类型的超集，它可以编译成纯JavaScript。</li>
<li>我的：TypeScript包含JS的语法，但是类型等方面更严格，可以根据代码设置的类型等进行提示。</li>
</ul>
<h2 id="2-基础准备"><a href="#2-基础准备" class="headerlink" title="2.基础准备"></a>2.基础准备</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 全局</span></span><br><span class="line">npm install -g typescript</span><br><span class="line"></span><br><span class="line"><span class="comment"># 本地</span></span><br><span class="line">npm install -D typescript</span><br></pre></td></tr></table></figure>

<h3 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 命令方式</span></span><br><span class="line">tsc helloworld.ts</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// package.json 脚本配置</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"tsc:build"</span>: <span class="string">"tsc"</span>,</span><br><span class="line">    <span class="attr">"tsc:watch"</span>: <span class="string">"tsc --watch"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Visual Studio Code - VSCode 编辑器 方式</span></span><br><span class="line">英文：Terminal -&gt; Run Task -&gt; tsc:build - tsconfig.json</span><br><span class="line">中文：终端 -&gt; 运行任务 -&gt; 选择就好了（虽然我的报错，about_Execution_Policies-执行策略的问题）</span><br></pre></td></tr></table></figure>

<h3 id="npm-项目应用-typescript"><a href="#npm-项目应用-typescript" class="headerlink" title="npm 项目应用 typescript"></a>npm 项目应用 typescript</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 首先 以下代码创建 package.json</span></span><br><span class="line"><span class="comment"># cnpm init -y</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 typescript 配置文件 tsconfig.json</span></span><br><span class="line">tsc --init</span><br></pre></td></tr></table></figure>

<h3 id="配置项解析（tsconfig-json）"><a href="#配置项解析（tsconfig-json）" class="headerlink" title="配置项解析（tsconfig.json）"></a>配置项解析（tsconfig.json）</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  /* 要把TS语言编译成es5语法 'ES3' (default), 'ES5', 'ES2015', 'ES2016', 'ES2017', 'ES2018', 'ES2019', 'ES2020', 'ES2021', or 'ESNEXT'. */</span><br><span class="line">  "target": "es5",</span><br><span class="line">  "module": "commonjs",  /* 模块形式 */</span><br><span class="line">  "esModuleInterop": true,  /* commonjs和es6模块转译，包导出为commonjs方式，导入时可以用es6方式导入 */</span><br><span class="line">  "strictNullChecks": false, /* 把 null 赋值给变量的时候，是否校验报错 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="namespace-amp-模块（module）小技巧"><a href="#namespace-amp-模块（module）小技巧" class="headerlink" title="namespace &amp; 模块（module）小技巧"></a>namespace &amp; 模块（module）小技巧</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name: <span class="built_in">string</span> = <span class="string">'a'</span>; <span class="comment">// 报错:无法重新声明块范围变量“name”。，因为生命name到全局globle了</span></span><br><span class="line"><span class="keyword">export</span> &#123;&#125; <span class="comment">// 加了这句，上面代码不报错了，因为当前文件已经是一个模块了，会在当前的命名空间下</span></span><br></pre></td></tr></table></figure>

<h2 id="3-基础知识讲解"><a href="#3-基础知识讲解" class="headerlink" title="3.基础知识讲解"></a>3.基础知识讲解</h2><h3 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 变量声明</span></span><br><span class="line"><span class="keyword">let</span> age: <span class="built_in">number</span> = <span class="number">9</span>; <span class="comment">// number</span></span><br><span class="line"><span class="keyword">let</span> name: <span class="built_in">string</span> = <span class="string">'a'</span>; <span class="comment">// string</span></span><br><span class="line"><span class="keyword">let</span> married: <span class="built_in">boolean</span> = <span class="literal">true</span>; <span class="comment">// boolean</span></span><br><span class="line"><span class="keyword">let</span> hobbies: <span class="built_in">string</span>[] = [<span class="string">'sing'</span>, <span class="string">'dance'</span>]; <span class="comment">// Array : 每一项都是string</span></span><br><span class="line"><span class="keyword">let</span> goodAt: <span class="built_in">Array</span>&lt;<span class="built_in">string</span>&gt; = [<span class="string">'sing'</span>]; <span class="comment">// 同上</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 元组: 类似数组，但是长度和类型都固定</span></span><br><span class="line"><span class="comment">// 特点： 1-长度固定   2-类型可以不一样</span></span><br><span class="line"><span class="keyword">let</span> point: [<span class="built_in">number</span>, <span class="built_in">number</span>] = [<span class="number">100</span>, <span class="number">100</span>]; <span class="comment">// 描述的是屏幕上的一个点</span></span><br><span class="line"><span class="keyword">let</span> person: [<span class="built_in">string</span>, <span class="built_in">number</span>] = [<span class="string">'Jack'</span>, <span class="number">10</span>]; <span class="comment">// 描述的事一个人</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 枚举: 列出一个事物的所有类型</span></span><br><span class="line"><span class="keyword">enum</span> Gender &#123;</span><br><span class="line">  BOY, <span class="comment">// 不设置指默认0开始递增</span></span><br><span class="line">  GIRL</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> s = <span class="string">'M'</span></span><br><span class="line"><span class="keyword">enum</span> AnimalGender &#123;</span><br><span class="line">  <span class="comment">// 属性值只可以是基本类型，也不能是计算表达式</span></span><br><span class="line">  <span class="comment">// N = true, // 报错：含字符串值成员的枚举中不允许使用计算值。</span></span><br><span class="line">  <span class="comment">// Y = s, // 报错：含字符串值成员的枚举中不允许使用计算值。</span></span><br><span class="line">  M = <span class="string">'M'</span>, </span><br><span class="line">  FM = <span class="string">'FM'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`I'm a <span class="subst">$&#123; Gender.GIRL &#125;</span>`</span>);</span><br><span class="line"><span class="keyword">enum</span> Week &#123;</span><br><span class="line">  MONDAY = <span class="number">1</span>, <span class="comment">// 设置值会按设置规则来</span></span><br><span class="line">  TUESDAY = <span class="number">2</span>,</span><br><span class="line">  SUNDAY = <span class="number">7</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`SUNDAY is <span class="subst">$&#123; Week.SUNDAY &#125;</span>`</span>);</span><br><span class="line"><span class="comment">// 常数枚举： 编译后找不到TrafficColors的定义，只剩下下面console这句了</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">enum</span> TrafficColors &#123;</span><br><span class="line">  Red,</span><br><span class="line">  Yellow,</span><br><span class="line">  Green</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`TrafficColors Red is <span class="subst">$&#123; TrafficColors.Red &#125;</span> `</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 任意类型 any : </span></span><br><span class="line"><span class="comment">// 实际自己写尽量不用any，除非数据结构太复杂太灵活</span></span><br><span class="line"><span class="comment">// 应用场景：第三方库没有类型定义、类型转换</span></span><br><span class="line"><span class="comment">// let root:HTMLElement | null = document.getElementById('root'); // 需要在浏览器执行才有document，所以先注释掉</span></span><br><span class="line"><span class="comment">// root!.style.color = 'red'; // ! 非空断言，root可能为null，不能给null赋值style属性，加！= 我能确定root是HTMLElement</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// null - 空 undefined - 未定义 都是其他类型的子类型，所以可以把他们赋值给其他类型的变量，但是配置要关闭strictNullChecks</span></span><br><span class="line"><span class="keyword">let</span> string1: <span class="built_in">string</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">let</span> string2: <span class="built_in">string</span> = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">let</span> x: <span class="built_in">number</span>;</span><br><span class="line">x = <span class="number">1</span>;</span><br><span class="line">x = <span class="literal">null</span>;</span><br><span class="line">x= <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// void 空-没有</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greeting</span>(<span class="params">name: <span class="built_in">string</span></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`hello <span class="subst">$&#123; name &#125;</span>`</span>);</span><br><span class="line">  <span class="comment">// return 1; // 报错：不能将类型“number”分配给类型“void”。 - 因为上面定义了void，不能有返回值类型</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span>; <span class="comment">// 不报错：因为null是任何类型的子类型</span></span><br><span class="line">&#125;</span><br><span class="line">greeting(<span class="string">'Marry'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// never 永远不：是其他类型的子类型，代表不会出现的值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createErr</span>(<span class="params">message: <span class="built_in">string</span></span>): <span class="title">never</span> </span>&#123;</span><br><span class="line">  <span class="comment">// never报错：返回“从不”的函数不能具有可访问的终结点。</span></span><br><span class="line">    <span class="comment">// 意思1:就是方法内不可以正常报错，要抛出错误才行</span></span><br><span class="line">    <span class="comment">// 意思2：死循环，永远不会执行到结束，下面sum例子</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'error'</span>); <span class="comment">// 有了这句，never不报错了  </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params"></span>):<span class="title">never</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'hello sum'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>); <span class="comment">// 检测到无法访问的代码。 - 这里永远不会执行，编辑器中会灰掉，这样情况never才不报错</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 类型推论</span></span><br><span class="line"><span class="keyword">let</span> no = <span class="number">2</span>;</span><br><span class="line">no = <span class="number">7</span>;</span><br><span class="line"><span class="comment">// no = '4'; // 报错，因为定义赋值的时候，赋值2，已经预定no的类型是number了</span></span><br><span class="line"><span class="keyword">let</span> not ; <span class="comment">// 定义的时候不设置类型，默认any</span></span><br><span class="line">not = <span class="number">4</span>;</span><br><span class="line">not = <span class="string">'4'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 包装对象：自动在基本类型和对象类型之间切换 java中叫装箱和拆箱</span></span><br><span class="line"><span class="comment">// 1.基本类型上没有方法</span></span><br><span class="line"><span class="comment">// 2.在内部迅速的完成一个装箱的操作，把基本类型包装成对象类型，然后用对象来调方法</span></span><br><span class="line"><span class="keyword">let</span> nameObj: <span class="built_in">string</span> = <span class="string">'zf'</span>;</span><br><span class="line">nameObj.toLocaleLowerCase(); <span class="comment">// 相当于：let tempNameObj = new String(nameObj);     tempNameObj.toLocaleLowerCase();</span></span><br><span class="line"><span class="keyword">let</span> isOk: <span class="built_in">boolean</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">let</span> isOk2: <span class="built_in">boolean</span> = <span class="built_in">Boolean</span>(<span class="number">1</span>); <span class="comment">// Boolean()会返回基本类型的布尔值，所以ok</span></span><br><span class="line"><span class="comment">// let isOk3: boolean = new Boolean(1); // new Boolean() 返回的是布尔类型对象，所以报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 联合类型</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">type</span>: <span class="built_in">string</span> | <span class="built_in">number</span>;</span><br><span class="line"><span class="keyword">type</span>.toString(); <span class="comment">// 这里只可以调用string和number都有的方法</span></span><br><span class="line"><span class="keyword">type</span> = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">type</span>.toString(); <span class="comment">// 这里确定了type的类型，可以调用number的所有方法</span></span><br><span class="line"><span class="keyword">type</span> = <span class="string">'5'</span>;</span><br><span class="line"><span class="keyword">type</span>.toString(); <span class="comment">// 这里确定type是string类型，所以可以调佣string的所有方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 类型断言 - 把一个变量断言成具体类型处理</span></span><br><span class="line"><span class="keyword">let</span> type2: <span class="built_in">string</span> | <span class="built_in">number</span>;</span><br><span class="line"><span class="comment">// 这里只可以调用string和number的公用方法，但是想调用string的方法，怎么办呢，如下断言</span></span><br><span class="line">(type2 <span class="keyword">as</span> <span class="built_in">string</span>).toLocaleLowerCase(); <span class="comment">// 把type当做字符串处理，可以调用string的方法</span></span><br><span class="line">(type2 <span class="keyword">as</span> <span class="built_in">number</span>).toFixed(<span class="number">2</span>); <span class="comment">// 把type当做字符串处理，可以调用string的方法</span></span><br><span class="line">type2 = <span class="string">'3'</span>;</span><br><span class="line"><span class="comment">// (type2 as number).toFixed(2); // 报错，给type2赋值string后，就不能再 as nuber 了</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字面量类型</span></span><br><span class="line"><span class="keyword">let</span> parentRole: <span class="string">'Mum'</span> | <span class="string">'Dad'</span>; <span class="comment">// parentRole 只可以被赋值为 Mum 或 Dad</span></span><br><span class="line">parentRole = <span class="string">'Mum'</span>;</span><br><span class="line">parentRole = <span class="string">'Dad'</span>;</span><br><span class="line"><span class="comment">// parentRole = 'Child'; // 报错：不能将类型“"Child"”分配给类型“"Mum" | "Dad"”。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数定义</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params">name: <span class="built_in">string</span></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">  <span class="comment">// void - 返回值类型</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'hello '</span> + name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 函数表达式</span></span><br><span class="line"><span class="comment">// type 定义一个类型或者类型别名       =&gt; 跟箭头函数没关系,后面内容定义的是返回值格式, 没有返回值用void</span></span><br><span class="line"><span class="keyword">type</span> GetUserNameType = <span class="function">(<span class="params">firstName: <span class="built_in">string</span>, lastName: <span class="built_in">string</span></span>) =&gt;</span> <span class="built_in">string</span>;</span><br><span class="line"><span class="comment">// GetUserNameType 的函数返回值为字符串   return 'aa'</span></span><br><span class="line"><span class="keyword">type</span> GetUserNameType2 = <span class="function">(<span class="params">firstName: <span class="built_in">string</span>, lastName: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">  name: <span class="built_in">string</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// GetUserNameType2 的函数返回值为包含一个name属性，且属性值为string类型的对象  return &#123; name: 'aa' &#125;</span></span><br><span class="line"><span class="keyword">let</span> getUserName: GetUserNameType = <span class="function"><span class="keyword">function</span>(<span class="params">firstName: <span class="built_in">string</span>, lastName: <span class="built_in">string</span></span>): <span class="title">string</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> firstName + <span class="string">' '</span> + lastName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可选参数 用?</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">print</span>(<span class="params">name: <span class="built_in">string</span>, age?: <span class="built_in">number</span>, home?: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">print(<span class="string">'jack'</span>); <span class="comment">// 不报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认参数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">url: <span class="built_in">string</span>, method: <span class="built_in">string</span> = 'GET'</span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">ajax(<span class="string">'/user'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 剩余参数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">...numbers: <span class="built_in">Array</span>&lt;<span class="built_in">number</span>&gt;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> numbers.reduce(<span class="function">(<span class="params">pre, item</span>) =&gt;</span> pre + item, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数重载 - 限定参数的形式</span></span><br><span class="line"><span class="keyword">let</span> obj: <span class="built_in">any</span> = &#123;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">attr</span>(<span class="params">val: <span class="built_in">string</span></span>) : <span class="title">void</span></span>; <span class="comment">// 相当于给attr函数增加了重载，接受string</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">attr</span>(<span class="params">val: <span class="built_in">number</span></span>) : <span class="title">void</span></span>; <span class="comment">// 相当于给attr函数增加了重载，接受number</span></span><br><span class="line"><span class="comment">// console.log('a'); // 报错，因为重载的定义和函数生命中间不能有其他代码，要紧挨着</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">attr</span>(<span class="params">val: <span class="built_in">any</span></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> val === <span class="string">'string'</span>) &#123;</span><br><span class="line">    obj.name = val;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> val === <span class="string">'number'</span>) &#123;</span><br><span class="line">    obj.age = val;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">attr(<span class="string">'jack'</span>);</span><br><span class="line">attr(<span class="number">10</span>);</span><br><span class="line"><span class="comment">// attr(true); // 定义了重载，报错</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum2</span> (<span class="params">a: <span class="built_in">number</span>, b: <span class="built_in">number</span></span>): <span class="title">void</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum2</span> (<span class="params">a: <span class="built_in">string</span>, b: <span class="built_in">string</span></span>): <span class="title">void</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum2</span> (<span class="params">a: <span class="built_in">any</span>, b:<span class="built_in">any</span></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line">sum2(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">sum2(<span class="string">'a'</span>, <span class="string">'b'</span>);</span><br><span class="line"><span class="comment">// sum2(1, 'b'); // 报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TS中写箭头函数 - 与JS相同</span></span><br><span class="line"><span class="keyword">let</span> delay = <span class="function">(<span class="params">ms: <span class="built_in">number</span></span>) =&gt;</span> &#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;, ms)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="类-class"><a href="#类-class" class="headerlink" title="类-class"></a>类-class</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义类</span></span><br><span class="line"><span class="keyword">class</span> Person &#123;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3.X版本的时候，属性名要初始化，如下写法</span></span><br><span class="line"><span class="keyword">class</span> Person3 &#123;</span><br><span class="line">  name: <span class="built_in">string</span> = <span class="string">'jack'</span>;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.age = <span class="number">10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="built_in">console</span>.log(p1);</span><br><span class="line"><span class="keyword">let</span> p3 = <span class="keyword">new</span> Person3();</span><br><span class="line"><span class="built_in">console</span>.log(p3);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> b &#123;</span><br><span class="line"><span class="comment">// 存取器 getter setter</span></span><br><span class="line"><span class="keyword">class</span> Person &#123;</span><br><span class="line">  myName: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.myName = name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">get</span> name() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.myName</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">set</span> name(val: <span class="built_in">string</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.myName = val.toUpperCase();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> Person(<span class="string">'jack'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(p.name);</span><br><span class="line">p.name = <span class="string">'Mary'</span>; <span class="comment">// 执行的set name() </span></span><br><span class="line"><span class="built_in">console</span>.log(p.name);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> c &#123;</span><br><span class="line">  <span class="comment">// 参数属性 - public</span></span><br><span class="line">  <span class="keyword">class</span> Person &#123;</span><br><span class="line">    <span class="comment">// name: string;</span></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"><span class="keyword">public</span> name: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> p = <span class="keyword">new</span> Person(<span class="string">'jack'</span>);</span><br><span class="line">  p.name; <span class="comment">// 加了 public ，不报错，public 把name属性定义到了类上,等同于name: string;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> c &#123;</span><br><span class="line">  <span class="comment">// readonly</span></span><br><span class="line">  <span class="keyword">class</span> Person &#123;</span><br><span class="line">    <span class="comment">// name: string;</span></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"><span class="keyword">public</span> readonly name: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> p = <span class="keyword">new</span> Person(<span class="string">'jack'</span>);</span><br><span class="line">  <span class="comment">// p.name = 'aa'; // 报错，不能赋值，因为readonly</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> d &#123;</span><br><span class="line">  <span class="comment">// 继承</span></span><br><span class="line">  <span class="keyword">class</span> Person &#123;</span><br><span class="line">    name: <span class="built_in">string</span>;</span><br><span class="line">    age: <span class="built_in">number</span>;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span>, age: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.name = name;</span><br><span class="line">      <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    getName() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line">    setName(newName: <span class="built_in">string</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.name = newName;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">class</span> Student <span class="keyword">extends</span> Person &#123;</span><br><span class="line">    stuNo: <span class="built_in">number</span>;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span>, age: <span class="built_in">number</span>, stuNo: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">      <span class="keyword">super</span>(name, age); <span class="comment">// super - 父类函数</span></span><br><span class="line">      <span class="keyword">this</span>.stuNo = stuNo;</span><br><span class="line">    &#125;</span><br><span class="line">    getStuNo() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.stuNo;</span><br><span class="line">    &#125;</span><br><span class="line">    setStuNo(newStuNo: <span class="built_in">number</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.stuNo = newStuNo;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> s = <span class="keyword">new</span> Student(<span class="string">'Ali'</span>, <span class="number">4</span>, <span class="number">9</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(s.getName()); <span class="comment">// 继承到了 Person 的 getName</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> e &#123;</span><br><span class="line">  <span class="comment">// 修饰符</span></span><br><span class="line">  <span class="comment">// public - 公开（自己和自己的子类都可以访问）</span></span><br><span class="line">  <span class="comment">// protected - 受保护的（自己和自己的子类能访问，其他类不能访问）</span></span><br><span class="line">  <span class="comment">// private - 私有（只能自己访问，子类也不能访问）</span></span><br><span class="line">  <span class="keyword">class</span> Person &#123;</span><br><span class="line">    <span class="keyword">public</span> name: <span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">protected</span> age: <span class="built_in">number</span>;</span><br><span class="line">    <span class="keyword">private</span> password: <span class="built_in">number</span>;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span>, age: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">      <span class="comment">// 自己，都可以访问</span></span><br><span class="line">      <span class="keyword">this</span>.name = name;</span><br><span class="line">      <span class="keyword">this</span>.age = age;</span><br><span class="line">      <span class="keyword">this</span>.password = <span class="number">111</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    getName() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line">    setName(newName: <span class="built_in">string</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.name = newName;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">class</span> Student <span class="keyword">extends</span> Person &#123;</span><br><span class="line">    <span class="comment">// 静态属性 静态方法 static</span></span><br><span class="line">    <span class="comment">// 静态 - 不需要实例化，类上本身的属性和方法</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">type</span> = <span class="string">'cn'</span></span><br><span class="line">    stuNo: <span class="built_in">number</span>;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span>, age: <span class="built_in">number</span>, stuNo: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">      <span class="keyword">super</span>(name, age); <span class="comment">// super - 父类函数</span></span><br><span class="line">      <span class="keyword">this</span>.stuNo = stuNo;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> getType() &#123;</span><br><span class="line">      <span class="keyword">return</span> Student.type</span><br><span class="line">    &#125;</span><br><span class="line">    getStuNo() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.name + <span class="keyword">this</span>.age + <span class="keyword">this</span>.stuNo;</span><br><span class="line">      <span class="comment">// protected age 可以访问, private paasword 不能访问</span></span><br><span class="line">    &#125;</span><br><span class="line">    setStuNo(newStuNo: <span class="built_in">number</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.stuNo = newStuNo;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> s = <span class="keyword">new</span> Student(<span class="string">'jack'</span>, <span class="number">10</span>, <span class="number">123</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(s.name);</span><br><span class="line">  <span class="comment">// console.log(s.age); // 报错：protected</span></span><br><span class="line">  <span class="comment">// console.log(s.paasword); // 报错：private</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(Student.type); <span class="comment">// 静态属性</span></span><br><span class="line">  <span class="built_in">console</span>.log(Student.getType()); <span class="comment">// 静态方法 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h3><h4 id="1-类装饰器"><a href="#1-类装饰器" class="headerlink" title="1-类装饰器"></a>1-类装饰器</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> a &#123;</span><br><span class="line">  <span class="comment">// tsconfig中需要放开"experimentalDecorators": true,</span></span><br><span class="line">  <span class="comment">// 1-类装饰器 ： 在类声明致歉生命，用来监视、修改或替换类定义,使用场景：别人写的类，想增强这个类，又不想改动别人的代码，可以写个类装饰器 ex：@more</span></span><br><span class="line">  <span class="keyword">interface</span> Person &#123;</span><br><span class="line">    xx: <span class="built_in">string</span>;</span><br><span class="line">    yy: <span class="built_in">string</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">more</span>(<span class="params">target: <span class="built_in">any</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// target - 装饰类的时候，指向Person定义</span></span><br><span class="line">    target.prototype.xx = <span class="string">'xx'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@more</span> <span class="comment">// 名字随意取</span></span><br><span class="line">  <span class="keyword">class</span> Person &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">  <span class="built_in">console</span>.log(p.xx);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> b &#123;</span><br><span class="line">  <span class="keyword">interface</span> Person &#123;</span><br><span class="line">    age: <span class="built_in">number</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">addAge</span>(<span class="params">target: <span class="built_in">any</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 这里直接重写了类，person已经不是person了</span></span><br><span class="line">    <span class="comment">// 但是Person里面有的属性，这里也必须要有，只能是增强的作用，不能减少，不能完全不同</span></span><br><span class="line">    <span class="comment">// return class &#123;</span></span><br><span class="line">    <span class="comment">//   age: number = 10;</span></span><br><span class="line">    <span class="comment">//   firstName: string = 'Chinese';</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// 以上不想重复定义firstName，可以返回继承的类</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">class</span> <span class="keyword">extends</span> Person &#123;</span><br><span class="line">      <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      age: <span class="built_in">number</span> = <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@addAge</span> <span class="comment">// 名字随意取</span></span><br><span class="line">  <span class="keyword">class</span> Person &#123;</span><br><span class="line">    firstName: <span class="built_in">string</span> = <span class="string">'person'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'---'</span>, p.age, <span class="string">'---'</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(p.firstName)</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> c &#123;</span><br><span class="line">  <span class="comment">// 装饰器工厂 - 装饰器函数返回真正的装饰器  @addAge('Mary')</span></span><br><span class="line">  <span class="keyword">interface</span> Person &#123;</span><br><span class="line">    lastName: <span class="built_in">string</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">addAge</span>(<span class="params">name: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">target: <span class="built_in">any</span></span>) </span>&#123; <span class="comment">// 这里才是真正的装饰器</span></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">class</span> <span class="keyword">extends</span> Person &#123;</span><br><span class="line">        lastName: <span class="built_in">string</span> = name;</span><br><span class="line">        <span class="keyword">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">super</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        getName() &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">this</span>.firstName + <span class="string">' '</span> + <span class="keyword">this</span>.lastName</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@addAge</span>(<span class="string">'Mary'</span>)</span><br><span class="line">  <span class="keyword">class</span> Person &#123;</span><br><span class="line">    firstName: <span class="built_in">string</span> = <span class="string">'person'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">  <span class="built_in">console</span>.log(p.firstName)</span><br><span class="line">  <span class="built_in">console</span>.log(p.lastName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-属性装饰器"><a href="#2-属性装饰器" class="headerlink" title="2-属性装饰器"></a>2-属性装饰器</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> d &#123;</span><br><span class="line">  <span class="comment">// 目的：赋值就变大写</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">upperCase</span>(<span class="params">target:<span class="built_in">any</span>, propertyName: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// target - 如果装饰的事普通属性(name)，target 指向类的原型(Person.prototype)</span></span><br><span class="line">    <span class="comment">// target - 如果装饰的事类的属性（static），那么target 指向类的定义</span></span><br><span class="line">    <span class="keyword">let</span> value = target[propertyName]; <span class="comment">// jack</span></span><br><span class="line">    <span class="keyword">const</span> getter = <span class="function"><span class="params">()</span> =&gt;</span> value;</span><br><span class="line">    <span class="keyword">const</span> setter = <span class="function">(<span class="params">newVal: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">      value = newVal.toUpperCase();</span><br><span class="line">    &#125;</span><br><span class="line">    Reflect.deleteProperty(target, propertyName);</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(target, propertyName, &#123;</span><br><span class="line">      <span class="keyword">get</span>: getter,</span><br><span class="line">      <span class="keyword">set</span>: setter,</span><br><span class="line">      enumerable: <span class="literal">true</span>, <span class="comment">// 是否可枚举</span></span><br><span class="line">      configurable: <span class="literal">true</span>, <span class="comment">// 是否可配置</span></span><br><span class="line">      <span class="comment">// writable: true, // 是否可写</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">methodEnumerable</span>(<span class="params">flag: <span class="built_in">boolean</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 描述方法 有3个参数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">target:<span class="built_in">any</span>, methodKey:<span class="built_in">string</span>, propertyDescriptor:PropertyDescriptor</span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">      <span class="comment">// target : 原型 | 类</span></span><br><span class="line">      <span class="comment">// methodKey ： 方法名</span></span><br><span class="line">      <span class="comment">// descriptor：属性描述器</span></span><br><span class="line">      propertyDescriptor.enumerable = flag;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">propEnumerable</span>(<span class="params">val: <span class="built_in">number</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target:<span class="built_in">any</span>, propertyName: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">let</span> value = target[propertyName]; <span class="comment">// jack</span></span><br><span class="line">      <span class="keyword">const</span> getter = <span class="function"><span class="params">()</span> =&gt;</span> value;</span><br><span class="line">      <span class="keyword">const</span> setter = <span class="function">(<span class="params">newVal: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">        value = newVal;</span><br><span class="line">      &#125;</span><br><span class="line">      Reflect.deleteProperty(target, propertyName);</span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(target, propertyName, &#123;</span><br><span class="line">        <span class="keyword">get</span>: getter,</span><br><span class="line">        <span class="keyword">set</span>: setter,</span><br><span class="line">        enumerable: <span class="literal">false</span>, <span class="comment">// 是否可枚举</span></span><br><span class="line">        configurable: <span class="literal">true</span>, <span class="comment">// 是否可配置</span></span><br><span class="line">        <span class="comment">// writable: true, // 是否可写</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">setAddr</span>(<span class="params">addr: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 描述方法 有3个参数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">target:<span class="built_in">any</span>, methodKey:<span class="built_in">string</span>, propertyDescriptor:PropertyDescriptor</span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">      <span class="comment">// target - 装饰的是类的属性（static 静态方法），那么target 指向类的定义</span></span><br><span class="line">      target.addr = addr;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">sunForNumber</span>(<span class="params">target:<span class="built_in">any</span>, methodKey:<span class="built_in">string</span>, propertyDescriptor:PropertyDescriptor</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> oldMethod = propertyDescriptor.value; <span class="comment">// sum方法</span></span><br><span class="line">    propertyDescriptor.value = <span class="function"><span class="keyword">function</span> (<span class="params">...args: <span class="built_in">any</span>[]</span>) </span>&#123;</span><br><span class="line">      args = args.map(<span class="function"><span class="params">item</span> =&gt;</span> <span class="built_in">parseFloat</span>(item));</span><br><span class="line">      <span class="keyword">return</span> oldMethod.apply(<span class="keyword">this</span>, args)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">class</span> Person &#123;</span><br><span class="line">    <span class="keyword">static</span> addr: <span class="built_in">string</span>;</span><br><span class="line">    <span class="meta">@upperCase</span></span><br><span class="line">    name: <span class="built_in">string</span> = <span class="string">'jack'</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@propEnumerable</span>(<span class="number">6</span>) <span class="comment">// 装饰属性，默认可枚举，改成不可枚举</span></span><br><span class="line">    age: <span class="built_in">number</span> = <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@methodEnumerable</span>(<span class="literal">true</span>)  <span class="comment">// 装饰方法，默认不可枚举，改成可枚举</span></span><br><span class="line">    getName() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'getName'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@setAddr</span>(<span class="string">'No 100'</span>)  <span class="comment">// 装饰!静态!方法</span></span><br><span class="line">    <span class="keyword">static</span> getAddr() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@sunForNumber</span></span><br><span class="line">    sum(...args: <span class="built_in">any</span>[]) &#123;</span><br><span class="line">      <span class="keyword">return</span> args.reduce(<span class="function">(<span class="params">pre, item</span>) =&gt;</span> pre + item, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'upperCase：name被大写了'</span>, p.name);</span><br><span class="line">  <span class="built_in">console</span>.log(p.age);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> attr <span class="keyword">in</span> p) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'propEnumerable &amp; methodEnumerable  设置为没有age，却有getName了--attr ==== '</span>, attr);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'setAddr：装饰器给静态addr赋值======'</span>, Person.addr);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'sum：sunForNumber: '</span>, p.sum(<span class="number">1</span>, <span class="string">'2'</span>, <span class="number">3</span>));</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-参数装饰器"><a href="#3-参数装饰器" class="headerlink" title="3-参数装饰器"></a>3-参数装饰器</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> d &#123;</span><br><span class="line">  <span class="keyword">interface</span> Person &#123;</span><br><span class="line">    mixPass: <span class="built_in">string</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">toMix</span>(<span class="params">target:<span class="built_in">any</span>, methodKey:<span class="built_in">string</span>, paramsIndex: <span class="built_in">Number</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// target : Person - prototype</span></span><br><span class="line">    <span class="built_in">console</span>.log(target, methodKey, paramsIndex);</span><br><span class="line">    target.mixPass = <span class="string">'123'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">class</span> Person &#123;</span><br><span class="line">    login(username: <span class="built_in">string</span>, <span class="meta">@toMix</span> password:<span class="built_in">string</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'username : password : mixPass === '</span>, username, password, <span class="keyword">this</span>.mixPass);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">  p.login(<span class="string">'aa'</span>, <span class="string">'11'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-装饰器的执行顺序"><a href="#4-装饰器的执行顺序" class="headerlink" title="4-装饰器的执行顺序"></a>4-装饰器的执行顺序</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// @Class1()</span><br><span class="line">// @Class2()</span><br><span class="line">// class Person &#123;</span><br><span class="line">//   @propName(&apos;name&apos;)</span><br><span class="line">//   name: string = &apos;name&apos;;</span><br><span class="line">//   @propAge(&apos;age&apos;)</span><br><span class="line">//   age: number = 19;</span><br><span class="line">//   @methodGreet()</span><br><span class="line">//   greet( @Param1() p1: string, @Param2() p2: string) &#123;</span><br><span class="line">//   &#125;</span><br><span class="line">// &#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 总体：：：属性 -&gt; 参数 -&gt; 方法  -&gt; 类</span><br><span class="line"> * 具体第一步：属性 | 方法  ， 谁在前谁先</span><br><span class="line"> * 具体第二步：方法（参数 + 方法），参数在前，方法在后</span><br><span class="line"> * 具体最后一步：类</span><br><span class="line"> * 同一类型的，位置挨着定义内容最近的先执行，ex类的：先@Class2()，再@Class1()</span><br><span class="line"> * @propName(&apos;name&apos;)</span><br><span class="line"> * @propAge(&apos;age&apos;)</span><br><span class="line"> * @Param2()</span><br><span class="line"> * @Param1()</span><br><span class="line"> * @methodGreet()</span><br><span class="line"> * @Class2()</span><br><span class="line"> * @Class1()</span><br><span class="line"> */</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://happychong.github.io/2021/08/05/typescript/" data-id="cl1dl9zej002qccnufpczl8ab" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/typescript/">typescript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="default-面试题总结（非Vue）" class="article article-type-default" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/08/05/面试题总结（非Vue）/" class="article-date">
  <time datetime="2021-08-04T16:00:00.000Z" itemprop="datePublished">2021-08-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/周边/">周边</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/05/面试题总结（非Vue）/">2021-08-05-面试题总结（非Vue）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id><a href="#" class="headerlink" title></a></h1><h2 id="1-模块"><a href="#1-模块" class="headerlink" title="1.模块"></a>1.模块</h2><ul>
<li>AMD CMD  require.js   sea.js</li>
<li>node:commonjs commonjs2</li>
<li>es6 module</li>
<li>umd: 兼容以上三种</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导出方式</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// commonjs </span></span><br><span class="line">exports.a = <span class="string">'a'</span>;</span><br><span class="line">exports.b = <span class="string">'b'</span>;</span><br><span class="line"><span class="built_in">module</span>.exports = <span class="string">'mod'</span></span><br><span class="line"><span class="comment">// es6</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> a = <span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> b = <span class="string">'b'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">'mod'</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入方式</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// commonjs </span></span><br><span class="line"><span class="keyword">let</span> moduleA = <span class="built_in">require</span>(<span class="string">'modA.js'</span>);</span><br><span class="line"><span class="comment">// moduleA = &#123;</span></span><br><span class="line"><span class="comment">//   a: 'a',</span></span><br><span class="line"><span class="comment">//   b: 'b',</span></span><br><span class="line"><span class="comment">//   default: 'mod'</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// es6 module</span></span><br><span class="line"><span class="keyword">import</span> moduleA, &#123;a, b&#125; <span class="keyword">from</span> <span class="string">'modA.js'</span>;</span><br></pre></td></tr></table></figure>

<p>## </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsc helloworld.ts</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://happychong.github.io/2021/08/05/面试题总结（非Vue）/" data-id="cl1dl9zem002tccnuxt2bcmmp" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/面试题/">面试题</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="default-git bash arrow 不能选择解决方案(windows)" class="article article-type-default" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/03/22/git bash arrow 不能选择解决方案(windows)/" class="article-date">
  <time datetime="2021-03-21T16:00:00.000Z" itemprop="datePublished">2021-03-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/周边/">周边</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/03/22/git bash arrow 不能选择解决方案(windows)/">git bash arrow 不能选择解决方案(windows)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id><a href="#" class="headerlink" title></a></h1><h2 id="1-情况说明"><a href="#1-情况说明" class="headerlink" title="1.情况说明"></a>1.情况说明</h2><p>创建cue-cli项目的时候，git bash 窗口中会出现选择项目，windows中某些情况下不支持上下箭头选择</p>
<h2 id="2-解决方案"><a href="#2-解决方案" class="headerlink" title="2.解决方案"></a>2.解决方案</h2><p>使用winpty,然后上下箭头就可以进行操作了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vue create 16.vue-cli-demo 改成如下</span></span><br><span class="line">winpty vue.cmd create 16.vue-cli-demo</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://happychong.github.io/2021/03/22/git bash arrow 不能选择解决方案(windows)/" data-id="cl1dl9zef002nccnuim3efetj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="default-Vue基础" class="article article-type-default" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/22/Vue基础/" class="article-date">
  <time datetime="2020-07-21T16:00:00.000Z" itemprop="datePublished">2020-07-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Vue/">Vue</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/22/Vue基础/">Vue 基础知识</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id><a href="#" class="headerlink" title></a></h1><p>下文的vm表示Vue的实例</p>
<h2 id="1-vm的常用属性及方法"><a href="#1-vm的常用属性及方法" class="headerlink" title="1 vm的常用属性及方法"></a>1 vm的常用属性及方法</h2><ul>
<li>vm.$el : 渲染页面后的真实dom元素(Vue+Jquery项目中常用)</li>
<li>vm.$watch(prop, fn) : 监控vm的data的属性值变化，监控的是diff后的变化，连着改值，fn只会异步被触发一次(下一事件环之后才会被触发)</li>
<li>vm.$nextTick(fn) : 把fn放在下一事件环执行</li>
<li>vm.$data : 当前实例-vm 的数据-data</li>
<li>vm.$options : 整个vm对象</li>
<li>vm.$set() : 动态新增属性—新增的属性，不实时更新视图，$set设置可以实时</li>
<li>vm.$delete() : 动态删除属性—更新数组的length，不实时更新视图，$delete设置可以实时</li>
</ul>
<h2 id="2-常用指令"><a href="#2-常用指令" class="headerlink" title="2 常用指令"></a>2 常用指令</h2><p>指令的功能是封装dom操作的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* &#123;&#123; &#125;&#125; ： 小胡子语法 取值 运算(算出返回结果) 三元表达式 &#123;&#123; &#123;name:1&#125; &#125;&#125; - ok的(要有空格)</span><br></pre></td></tr></table></figure>

<ul>
<li>v-once ：只渲染一次，再改值，界面不变</li>
<li>v-html ：可以将模板字符串(<code>&lt;h1&gt;我是标题&lt;/h1&gt;</code>)渲染成页面中的标题，原理innerHTML，注意不要将用户输入的内容显示到页面上以防止xss攻击</li>
<li>v-bind ：动态绑定，缩写 : (冒号)</li>
<li>v-for ：循环，可以循环数组、对象、数字、字符串，要循环谁就把v-for写在谁的标签上</li>
<li><ul>
<li>循环内容为多标签的话，可以循环外层套 template 标签,此时:key放template里面的标签上</li>
</ul>
</li>
<li><ul>
<li>key ： 配合v-for使用，用key进行更新，所以key具有唯一性，尽量不要用数组的索引做key的值(除非只做静态展示可以使用key)，否则反序操作的时候，会把元素删除重新创建，如果key是唯一性的值，改变数据顺序，只会改变dom顺序，效率高</li>
</ul>
</li>
<li><ul>
<li>可以自己拼接key保证唯一性</li>
</ul>
</li>
<li>v-if / else ：控制dom是否创建显示</li>
<li><ul>
<li>v-for 和 v-if 不要放在同一个标签中使用</li>
</ul>
</li>
<li>v-show ：控制dom显示，隐藏，不能在 template 标签上使用</li>
<li>v-on ：绑定事件方法，缩写 @ ex. @input @change</li>
<li>v-model ：双向绑定语法糖(能改内容的dom可以双向绑定) ,原理 :value + @input</li>
</ul>
<h2 id="fn"><a href="#fn" class="headerlink" title="fn"></a>fn</h2><p>vm的data中，可以定义方法，也可以成功执行，但是这个方法中的this会是windows</p>
<p>一般，我们在vm的methods中定义方法，这样方法中的this会是vm，但是methods中的方法中的this都定义成了vm，重新bind也无效，因为vue已经bind一次了，而bind绑定一次this就会绑死，多次绑定无效，这引发的问题就是这个方法如果在别的实例中应用会有问题，因为这个方法的this只能是当前实例</p>
<h2 id="自定义指令"><a href="#自定义指令" class="headerlink" title="自定义指令"></a>自定义指令</h2><h3 id="全局指令"><a href="#全局指令" class="headerlink" title="全局指令"></a>全局指令</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Vue 自定义全局指令 --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue 自定义全局指令(directive)<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">   1<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-focus1.a.b.c</span>=<span class="string">"'xxx'"</span>/&gt;</span> </span><br><span class="line">   2<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-focus2.color</span>=<span class="string">"'red'"</span>/&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/vue/dist/vue.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 全局指令</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 设置方法1 = 设置方法2中只有 bind 和 update 的语法糖</span></span></span><br><span class="line"><span class="javascript">    Vue.directive(<span class="string">'focus1'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">el, bindings, vNode</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// el - 当前指令元素</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// bindings - 绑定属性（修饰符-modifiers、表达式-expression、value等）</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// vNode - 虚拟节点 有context属性代表当前指令的上下文</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="comment">// 这个方法默认只在 bind（绑定）的时候和 update(更新-当前指令依赖的数据变化)的时候才会被执行</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(el, bindings, vNode);</span></span><br><span class="line"><span class="javascript">      el.focus(); <span class="comment">// 没效果 因为页面还没初始化好el这个dom节点 应该插入dom之后再执行focus方法，如inserted中</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="comment">// 设置方法2</span></span></span><br><span class="line"><span class="javascript">    Vue.directive(<span class="string">'focus2'</span>, &#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 指令的触发周期顺序(最常用的) bind -&gt; inserted -&gt; update -&gt; unbind</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// bind (el, bindings, vNode) &#123;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//   console.log(el, bindings, vNode);</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//   el.focus();</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//   // 可以用 nextTick 实现 inserted 效果</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// &#125;,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// update (el, bindings, vNode) &#123;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//   console.log(el, bindings, vNode);</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//   el.focus();</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// &#125;,</span></span></span><br><span class="line">      inserted(el, bindings, vNode) &#123;</span><br><span class="line"><span class="javascript">        <span class="comment">// 插入（初始化）dom之后执行此方法</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// 指令 focus2 中，有修饰符color的，把dom边框变成设置的颜色</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (bindings.modifiers.color) &#123;</span></span><br><span class="line">          el.style.borderColor = bindings.value;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        el.focus(); <span class="comment">// focus2 指令的元素自动获取焦点</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      unbind() &#123;</span><br><span class="line"><span class="javascript">        <span class="comment">// 指令小会的时候 会触发此函数</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span></span></span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="组件内指令"><a href="#组件内指令" class="headerlink" title="组件内指令"></a>组件内指令</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Vue clickOutside指令 --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue clickOutside指令<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    .input &#123; border: 1px solid red;&#125;</span><br><span class="line">    .content &#123; background-color: bisque;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    日历控件 | 弾层 ： </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-click-outside</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">"isShow"</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">        内容</span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span>&gt;</span>加载更多内容<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/vue/dist/vue.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      directives: &#123;</span><br><span class="line"><span class="javascript">        <span class="comment">// 局部指令 只当前vm有效</span></span></span><br><span class="line">        clickOutside:&#123;</span><br><span class="line"><span class="javascript">          <span class="comment">// 可以实现 点击时判断是否存在当前dom中</span></span></span><br><span class="line">          bind(el, bindings, vNode) &#123;</span><br><span class="line"><span class="javascript">            el.fn = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">              <span class="keyword">if</span> (el.contains(e.target)) &#123;</span></span><br><span class="line">                vNode.context.showContent();</span><br><span class="line"><span class="javascript">              &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line">                vNode.context.hideContent();</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;;</span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.addEventListener(<span class="string">'click'</span>, el.fn);</span></span><br><span class="line">          &#125;,</span><br><span class="line">          unbind(el) &#123;</span><br><span class="line"><span class="javascript">            <span class="comment">// 事件绑定必须要解绑</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.removeEventListener(<span class="string">'click'</span>, el.fn);</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="javascript">        isShow: <span class="literal">false</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        showContent() &#123;</span><br><span class="line"><span class="javascript">          <span class="keyword">this</span>.isShow = <span class="literal">true</span>;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        hideContent() &#123;</span><br><span class="line"><span class="javascript">          <span class="keyword">this</span>.isShow = <span class="literal">false</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="computed-amp-watch-的区别"><a href="#computed-amp-watch-的区别" class="headerlink" title="computed &amp; watch 的区别"></a>computed &amp; watch 的区别</h2><p>computed 计算：会根据其他的值来计算，特点：内部具有缓存，如果依赖的属性没有变化，不会重新执行对应的函数，依赖的属性变化，再重新执行</p>
<p>watch 监控：监控某个值的变化，每次值变化后，都能执行对应的回调</p>
<p>computed 和 watch 都是基于 vm.$watch 实现的</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- computed &amp; watch --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue clickOutside指令<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    .input &#123; border: 1px solid red;&#125;</span><br><span class="line">    .content &#123; background-color: bisque;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/vue/dist/vue.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="javascript">        name: <span class="string">'z3'</span>,</span></span><br><span class="line"><span class="javascript">        <span class="comment">// name: &#123;</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   n: 'l4'</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// &#125;</span></span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="comment">// watch: &#123;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//   // 当一个值变化了，可以做其他的事</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//   name: &#123;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     handler(newValue) &#123;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//       console.log('watch ::', newValue);</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     &#125;,</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     immediate: true, // 立即执行handler 初始化时候就执行</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     deep: true, // 深度监控 ex. name.n 变化，也会触发 watch 方法，newValue 是name，不是name.n</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//     lazy: true // 是 computed 的实现</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">//   &#125;</span></span></span><br><span class="line"><span class="javascript">      <span class="comment">// &#125;,</span></span></span><br><span class="line">      computed: &#123;</span><br><span class="line">        fullName() &#123;</span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> vm.name + <span class="string">'-jw'</span></span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="comment">// Vue 的 watch 实现 - 注释掉上面的watch，这里模拟设置监控</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// function initWatch(watch) &#123;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//   for (let key in watch) &#123;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//     vm.$watch(key, watch[key]);</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//   &#125;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// &#125;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// initWatch(&#123;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//   name(newValue) &#123;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//     console.log(newValue);</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//   &#125;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// &#125;)</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="comment">// Vue 的 computed 实现 - 注释掉上面的computed，这里模拟设置 computed</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// let dirty = true; // 获取过就不再执行handler方法，直接返回已经计算出的结果</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// function initComputed(key, handler) &#123;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//   let value;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//   Object.defineProperty(vm, key, &#123;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//     get() &#123;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//       if (dirty) &#123;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//         value = handler();</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//         dirty = false;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//       &#125;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//       return value;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//     &#125;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//   &#125;)</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// &#125;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// initComputed('fullName', () =&gt; &#123;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//   console.log('computed handler run');</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//   return vm.name + 'jw'</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// &#125;);</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// vm.fullName</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// vm.fullName</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// // ↑ vm.fullName 重新获取，不重新执行handler方法</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// vm.name = 'xxx';</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// dirty = true; // name 重新赋值，实际相当于 dirty 重置为 true</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// vm.fullName // 所以这里获取 fullName ，重新执行handler方法</span></span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Vue-的生命周期"><a href="#Vue-的生命周期" class="headerlink" title="Vue 的生命周期"></a>Vue 的生命周期</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生命周期的执行是同步的，其中包含异步逻辑的话，不会等待，直接执行后续的函数</span></span><br><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  <span class="comment">// 当前这个实例他的父亲是谁 儿子是谁</span></span><br><span class="line">  beforeCreate() &#123;</span><br><span class="line">    <span class="comment">// 组件创建之前 - 初始化好了基础属性，基础事件（$on $emit 等）</span></span><br><span class="line">    <span class="comment">// 但this（vm）中不包含vm的数据(data)、方法、watch等，所以基本上业务逻辑不需要使用这个钩子</span></span><br><span class="line">    <span class="comment">// 混合 ： 我希望在每个组件中增加一些特定的属性，可以采用这个钩子</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>, <span class="string">'beforeCreate-组件创建之前--'</span>, <span class="keyword">this</span>.n); <span class="comment">// 没有n</span></span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    <span class="comment">// 创建完成 - 当前这个组件实例，已经实现了数据劫持（数据已经加了get，set），并把方法、计算属性都挂载到了实例上</span></span><br><span class="line">    <span class="comment">// 但是不能获取到真是的dom元素，不能操作dom</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>, <span class="string">'created-创建完成--'</span>, <span class="keyword">this</span>.$el); <span class="comment">// 没有dom</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// el: '#app', // 同vm.$mount('#app');</span></span><br><span class="line">  render(h) &#123;</span><br><span class="line">    <span class="comment">// 如果有的render 就不会使用template内容了，</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">4</span>, <span class="string">'render'</span>);</span><br><span class="line">    <span class="keyword">return</span> h(<span class="string">'div'</span>, &#123;&#125;, [<span class="string">'render方法创建的'</span>])</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// template: `&lt;div&gt;hello&lt;/div&gt;`, // 会把template变成render方法</span></span><br><span class="line">  data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      n: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  beforeMount() &#123;</span><br><span class="line">    <span class="comment">// 挂载之前 - beforeMount中会默认调用render方法</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>, <span class="string">'beforeMount-挂载之前 --'</span>, <span class="keyword">this</span>.$el);</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123; <span class="comment">// 这个过程中，如果有子组件，会走子组件的生命周期，洋葱模式</span></span><br><span class="line">    <span class="comment">// 当前组件挂载完成 - 有了真实的dom</span></span><br><span class="line">    <span class="comment">// 一般把ajax的操作，在这里完成，既能得到vm数据，又有$el方便操作</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">5</span>, <span class="string">'mounted-挂载完成 --'</span>, <span class="keyword">this</span>.$el);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// Vue 更新方式是组件级别的</span></span><br><span class="line">  <span class="comment">// 组件化的好处 1：方便复用，好维护 2：减少不必要的更新渲染</span></span><br><span class="line">  beforeUpdate() &#123;</span><br><span class="line">    <span class="comment">// 更新之前 - Vue的更新是diff更新，需要更新的数据在视图中显示，才会触发beforeUpdate</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'beforeUpdate-更新之前'</span>);</span><br><span class="line">    <span class="comment">// 我们可以在这里增加一些数据更新，不会导致视图多次更新，很少用</span></span><br><span class="line">  &#125;,</span><br><span class="line">  updated() &#123; <span class="comment">// 这里不要再更新数据，可能会死循环</span></span><br><span class="line">    <span class="comment">// 更新完成</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'updated-更新完成'</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 触发销毁的方式：- 销毁后会默认移除所有观察者，移除监听事件（watcher.active = false），视图并不会刷新</span></span><br><span class="line">  <span class="comment">// 1-手动移除组件（vm.$destroy()）</span></span><br><span class="line">  <span class="comment">// 2-路由切换</span></span><br><span class="line">  beforeDestroy() &#123;</span><br><span class="line">    <span class="comment">// 销毁之前 - 可以做事件移除 清空定时器等</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'beforeDestroy-销毁之前'</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  destroyed() &#123;</span><br><span class="line">    <span class="comment">// 销毁后</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'destroyed-销毁后'</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// $mount 挂载节点</span></span><br><span class="line">vm.$mount(<span class="string">'#app'</span>);</span><br><span class="line"><span class="comment">// 可以指定一个元素，作为渲染内容的父节点</span></span><br><span class="line"><span class="comment">// vm.$mount();</span></span><br><span class="line"><span class="comment">// 不指定（参数为空）元素的话，内部会默认渲染到内存中的一个节点，可以原生js自己appendChild到页面中</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建的内容-优先级：</span></span><br><span class="line"><span class="comment">// 1：render方法中返回的dom节点</span></span><br><span class="line"><span class="comment">// 2：template。会把template变成render方法</span></span><br><span class="line"><span class="comment">// 3：dom中的挂载节点的内容 ex. &lt;div id="app"&gt;</span></span><br><span class="line"><span class="built_in">console</span>.log(vm.$el);</span><br></pre></td></tr></table></figure>

<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><p>组件的目的：复用、方便维护、减少渲染</p>
<p>组件的分类：全局组件、局部组件、指令组件</p>
<p>组件的使用：</p>
<ul>
<li>1.导入组件</li>
<li>2.注册</li>
<li>3.使用 - 在当前组件定义的模板中使用</li>
</ul>
<h3 id="全局组件"><a href="#全局组件" class="headerlink" title="全局组件"></a>全局组件</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">all-component</span>&gt;</span><span class="tag">&lt;/<span class="name">all-component</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">all-component</span>&gt;</span><span class="tag">&lt;/<span class="name">all-component</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;/all-component&gt;&lt;/all-component&gt;&lt;/all-component&gt; --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      html中应用要注意：</span></span><br><span class="line"><span class="comment">      1.不支持自定义闭合标签</span></span><br><span class="line"><span class="comment">      2.标签名不要和原生标签重名</span></span><br><span class="line"><span class="comment">      3.如果组件名有大写的情况会默认转为小写，会有问题，因为html标签无大写，要全部采用小写+短横线（-）方式</span></span><br><span class="line"><span class="comment">      4.组件应该是独立的，每个组件间应该是不想管的，并且单项数据流，所以data要是函数，返回独立的&#123;&#125;</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/vue/dist/vue.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 组件的目的：复用、方便维护、减少渲染</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 组件的分类：全局组件、局部组件、指令组件</span></span></span><br><span class="line"><span class="javascript">    Vue.component(<span class="string">'all-component'</span>, &#123; <span class="comment">// 注册全局组件</span></span></span><br><span class="line"><span class="xml">      template: `<span class="tag">&lt;<span class="name">div</span>&gt;</span>全局组件内容<span class="tag">&lt;/<span class="name">div</span>&gt;</span>`,</span></span><br><span class="line">      data() &#123;</span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> &#123;&#125;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span></span></span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="局部组件"><a href="#局部组件" class="headerlink" title="局部组件"></a>局部组件</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">inner-component</span> <span class="attr">:money</span>=<span class="string">"money"</span>&gt;</span><span class="tag">&lt;/<span class="name">inner-component</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/vue/dist/vue.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 每个组件都应该有3部分 1-html 2-js 3-style</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> component = &#123;</span></span><br><span class="line"><span class="xml">      template: `<span class="tag">&lt;<span class="name">div</span>&gt;</span>子组件<span class="tag">&lt;/<span class="name">br</span>&gt;</span></span></span><br><span class="line">        My father's money is &#123;&#123; money &#125;&#125; .</span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"addMoney"</span>&gt;</span>我赚10元给father<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="xml">        My house : &#123;&#123; house &#125;&#125;<span class="tag">&lt;/<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="xml">        My dog : &#123;&#123; dog &#125;&#125;<span class="tag">&lt;/<span class="name">br</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span>`,</span></span><br><span class="line">      data() &#123;</span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> &#123;<span class="attr">n</span>: <span class="number">1</span>&#125;</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      <span class="comment">// props: ['money'], // 直接拿属性用</span></span></span><br><span class="line"><span class="javascript">      props: &#123; <span class="comment">// 对属性进行校验</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// money: &#123;&#125; // 不校验 等于上面数组写法</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// money: Number // </span></span></span><br><span class="line">        money: &#123;</span><br><span class="line"><span class="javascript">          type: <span class="built_in">Number</span>, <span class="comment">// 类型校验 - money为Number类型</span></span></span><br><span class="line"><span class="javascript">          required: <span class="literal">true</span>, <span class="comment">// 必填校验</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">default</span>: <span class="number">10</span> <span class="comment">// 设置默认值</span></span></span><br><span class="line">        &#125;,</span><br><span class="line">        house: &#123;</span><br><span class="line"><span class="javascript">          type: <span class="built_in">Array</span>, <span class="comment">// Array 或者 Object 类型的时候，并且设置默认值，默认值设置需要用函数返回值方式设置</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">default</span>: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> [<span class="number">1</span>]</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        dog: &#123;</span><br><span class="line"><span class="javascript">          type: <span class="built_in">Object</span>,</span></span><br><span class="line"><span class="javascript">          <span class="keyword">default</span>: <span class="function"><span class="params">()</span> =&gt;</span> (&#123;<span class="attr">a</span>: <span class="number">1</span>&#125;)</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        addMoney() &#123;</span><br><span class="line"><span class="javascript">          <span class="comment">// this.money = this.money + 10; // 不应该子组件修改父组件的数据</span></span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="javascript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line">        money: 100,</span><br><span class="line">        house: [1, 2, 3]</span><br><span class="line">      &#125;,</span><br><span class="line"><span class="javascript">      components: &#123; <span class="comment">// 在实例上注册组件</span></span></span><br><span class="line"><span class="javascript">        <span class="string">'inner-component'</span>: component</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="dispatch-向上触发事件方法"><a href="#dispatch-向上触发事件方法" class="headerlink" title="dispatch 向上触发事件方法"></a>dispatch 向上触发事件方法</h3><p>dispatch Vue1.0的时候有，2.0以后，就被干掉了，下面是自己封装方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Vue.prototype.$dispatch = <span class="function"><span class="keyword">function</span> (<span class="params">eventName, value</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 触发所有层级的父亲上的eventName事件</span></span><br><span class="line">  <span class="keyword">let</span> parent = <span class="keyword">this</span>.$parent;</span><br><span class="line">  <span class="keyword">while</span> (parent) &#123;</span><br><span class="line">    parent.$emit(eventName, value);</span><br><span class="line">    parent = parent.$parent;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="broadcast-广播-触发所有子组件带有eat的事件方法"><a href="#broadcast-广播-触发所有子组件带有eat的事件方法" class="headerlink" title="broadcast 广播 - 触发所有子组件带有eat的事件方法"></a>broadcast 广播 - 触发所有子组件带有eat的事件方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Vue.prototype.$broadcast = <span class="function"><span class="keyword">function</span> (<span class="params">eventName, value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> children = <span class="keyword">this</span>.$children;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">booad</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    children.forEach(<span class="function"><span class="params">child</span> =&gt;</span> &#123;</span><br><span class="line">      child.$emit(eventName, value);</span><br><span class="line">      <span class="keyword">if</span> (child.$children) &#123;</span><br><span class="line">        booad(child.$children);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  booad(children);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="组件通信"><a href="#组件通信" class="headerlink" title="组件通信"></a>组件通信</h3><p><a href="https://github.com/happychong/2019-zhufeng/15.Vue/12-last" target="_blank" rel="noopener">文件源码地址</a></p>
<h4 id="父传递给子数据-props-emit"><a href="#父传递给子数据-props-emit" class="headerlink" title="父传递给子数据 props emit"></a>父传递给子数据 props emit</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  props --》 count</span></span><br><span class="line"><span class="comment">  emit ---》 changeCount() &#123; this.$emit('update:count', 5) &#125;</span></span><br><span class="line"><span class="comment">  以下写法是演变过程 与 语法糖 其实都是一样的功能</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 写法1 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> <span class="attr">:count</span>=<span class="string">"count"</span> @<span class="attr">update:count</span>=<span class="string">"changeCount"</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 写法2 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> <span class="attr">:count</span>=<span class="string">"count"</span> @<span class="attr">update:count</span>=<span class="string">"newValue =&gt; count = newValue"</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 写法3 .sync写法，组件内需要触发（emit）的方法执行，必须是update:当前属性名（这里是count）方式触发--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> <span class="attr">:count.sync</span>=<span class="string">"count"</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 写法4 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> <span class="attr">:value</span>=<span class="string">"count"</span> @<span class="attr">input</span>=<span class="string">"newValue =&gt; count = newValue"</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 写法5 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> <span class="attr">v-model</span>=<span class="string">"count"</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="parent-children"><a href="#parent-children" class="headerlink" title="$parent $children"></a>$parent $children</h4><p>$parent — 获取父组件，$children — 获取所有子组件</p>
<h4 id="attrs-listeners"><a href="#attrs-listeners" class="headerlink" title="$attrs $listeners"></a>$attrs $listeners</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">grandSon</span> <span class="attr">v-bind</span>=<span class="string">"$attrs"</span> <span class="attr">v-on</span>=<span class="string">"$listeners"</span> @<span class="attr">click</span>=<span class="string">"eat"</span> @<span class="attr">click.native</span>=<span class="string">"show"</span>&gt;</span><span class="tag">&lt;/<span class="name">grandSon</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    v-bind="$attrs" 这是直接把当前组件所有的属性都传到 grandSon 组件</span></span><br><span class="line"><span class="comment">    v-on="$listeners" : 把所有方法都传给子组件</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="provide-inject-和-context"><a href="#provide-inject-和-context" class="headerlink" title="provide inject 和 context"></a>provide inject 和 context</h4><p>可以在父组件中声明公共数据，在子组件中注入，比较混乱-名称问题，不知道拿的谁的数据，一般不在业务代码中使用，多用于组件库中多及通信</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// provide inject</span></span><br><span class="line"><span class="comment">// 子组件中 - git\2019-zhufeng\15.Vue\12-last\components\grandSon.vue</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  inject: [<span class="string">'vm'</span>], <span class="comment">// inject 注入，会向上查找（找到就停止，比如son中也provide暴露了vm，那找到的就是son的），这里直接拿到了App.vue provide 的内容</span></span><br><span class="line">  mounted() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'vm'</span>, <span class="keyword">this</span>.vm); <span class="comment">// 这里直接获取到了App.vue 实例</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// App.vue中</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  provide() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="comment">// 暴露全局方法</span></span><br><span class="line">      vm: <span class="keyword">this</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    doFn() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'doFn'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h4><p>获取真实的dom元素，如果放到组件上代表当前组件的实例，ref不要重名，会被覆盖，只有v-for循环的时候才会是数组形式</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- parent --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Son</span> <span class="attr">ref</span>=<span class="string">"son"</span>&gt;</span><span class="tag">&lt;/<span class="name">Son</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// parent</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">   mounted() &#123;</span><br><span class="line">    <span class="keyword">this</span>.$refs.son.show(); <span class="comment">// 父组件直接调用了子组件的方法</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// son</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    show() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'show'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="eventbus"><a href="#eventbus" class="headerlink" title="eventbus"></a>eventbus</h4><p>以上方式的绑定，都是只能在当前绑定事件的组建中才能触发事件，比如A实例绑定的aListeners   a.$on(‘aListeners’)，只能在A实例中才能触发 a.$emit(‘aListeners’, ‘hi’)，如果B想触发，需要找到A，在A上触发，不可以直接触发 不可以直接b.$emit(‘aListeners’, ‘hi’)。</p>
<p>eventbus 思路就是创建一个C实例，给c绑定一个事件，那么我们可以在a中触发c的事件 –》 c.$emit()，也可以在b中触发c的事件，谁都可以触发c的事件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这里代表3个文件内容，main，parent，和grandson</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js - Vue中创建全局对象</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span>;</span><br><span class="line"><span class="comment">// 创建一个全局的发布订阅，数据流很混乱，偶尔用一次还可以</span></span><br><span class="line"><span class="comment">// $bus 只要创建一个有发布订阅功能的对象就行了，new Vue()就有</span></span><br><span class="line">Vue.prototype.$bus = <span class="keyword">new</span> Vue();</span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// parent - 全局对象绑定事件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    <span class="comment">// 绑定 $bus 事件   this.$bus是全局的，绑定好后，就可以任意位置触发了</span></span><br><span class="line">    <span class="keyword">this</span>.$bus.$on(<span class="string">'change'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'this.$bus.$on 执行了'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// grandson - 触发绑定的事件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.$bus.$emit(<span class="string">'change'</span>); <span class="comment">// 触发 $bus 事件</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="递归组件"><a href="#递归组件" class="headerlink" title="递归组件"></a>递归组件</h3><p>递归组件 - 需要给当前要递归的组件提供一个name属性，并且可以在当前组件内部，通过name来调用自己</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- - git\2019-zhufeng\15.Vue\13-menu\ReSub.vue 这是一个递归组件（reSub），整体案例是无限极菜单 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mySubMenu</span> <span class="attr">v-if</span>=<span class="string">"data &amp;&amp; data.children &amp;&amp; data.children.length &gt; 0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">"title"</span>&gt;</span>&#123;&#123; data.name &#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-for</span>=<span class="string">"item in data.children"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">reSub</span> <span class="attr">:data</span>=<span class="string">"item"</span> <span class="attr">:key</span>=<span class="string">"item.id"</span>&gt;</span><span class="tag">&lt;/<span class="name">reSub</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mySubMenu</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">myMenuItem</span> <span class="attr">v-else</span> <span class="attr">:key</span>=<span class="string">"data.id"</span>&gt;</span>&#123;&#123; data.name &#125;&#125;<span class="tag">&lt;/<span class="name">myMenuItem</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mySubMenu <span class="keyword">from</span> <span class="string">"./components/my-submenu"</span>;</span><br><span class="line"><span class="keyword">import</span> myMenuItem <span class="keyword">from</span> <span class="string">"./components/my-menu-item"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">'reSub'</span>, <span class="comment">// 递归组件 - 需要给当前要递归的组件提供一个name属性，并且可以在当前组件内部，通过name来调用自己</span></span><br><span class="line">  props: &#123;</span><br><span class="line">    data: &#123;</span><br><span class="line">      type: <span class="built_in">Object</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    myMenuItem,</span><br><span class="line">    mySubMenu</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://github.com/happychong/2019-zhufeng/13-menu" target="_blank" rel="noopener">源码地址</a></p>
<p>87 88</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://happychong.github.io/2020/07/22/Vue基础/" data-id="cl1dl9ze10029ccnuv9ri2kdj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vue/">Vue</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="default-Vue面试题" class="article article-type-default" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/22/Vue面试题/" class="article-date">
  <time datetime="2020-07-21T16:00:00.000Z" itemprop="datePublished">2020-07-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Vue/">Vue</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/22/Vue面试题/">Vue 面试题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id><a href="#" class="headerlink" title></a></h1><h2 id="1-请说下对MVVM的理解"><a href="#1-请说下对MVVM的理解" class="headerlink" title="1 请说下对MVVM的理解"></a>1 请说下对MVVM的理解</h2><p>MVVM：model + view + viewModel</p>
<p>MVC：model + view + control</p>
<h2 id="2-Vue-实现数据双向绑定的原理"><a href="#2-Vue-实现数据双向绑定的原理" class="headerlink" title="2 Vue 实现数据双向绑定的原理"></a>2 Vue 实现数据双向绑定的原理</h2><p>Object.defineProperty <a href>点击查看更多代码</a></p>
<h2 id="3-Vue-常用的指令有哪些？"><a href="#3-Vue-常用的指令有哪些？" class="headerlink" title="3 Vue 常用的指令有哪些？"></a>3 Vue 常用的指令有哪些？</h2><p>v-once 、 v-html 、 v-bind 、 v-for 、 key 、 v-if / else 、 v-if 、 v-show 、 v-on 、 v-model </p>
<h2 id="4-v-model-的原理"><a href="#4-v-model-的原理" class="headerlink" title="4 v-model 的原理"></a>4 v-model 的原理</h2><p>:value + @input</p>
<h2 id="5-v-if-和-v-show-的区别"><a href="#5-v-if-和-v-show-的区别" class="headerlink" title="5 v-if 和 v-show 的区别"></a>5 v-if 和 v-show 的区别</h2><p>v-if：dom是否创建</p>
<p>v-show：dom是否在界面中可见 style</p>
<h2 id="6-Vue-中-key-值的作用"><a href="#6-Vue-中-key-值的作用" class="headerlink" title="6 Vue 中 key 值的作用"></a>6 Vue 中 key 值的作用</h2><p>更新视图，key要保证唯一性</p>
<h2 id="7-computed-和-watch-有什么区别？"><a href="#7-computed-和-watch-有什么区别？" class="headerlink" title="7 computed 和 watch 有什么区别？"></a>7 computed 和 watch 有什么区别？</h2><h2 id="8-Vue-的生命周期，每个生命周期具体适合哪些场景？"><a href="#8-Vue-的生命周期，每个生命周期具体适合哪些场景？" class="headerlink" title="8 Vue 的生命周期，每个生命周期具体适合哪些场景？"></a>8 Vue 的生命周期，每个生命周期具体适合哪些场景？</h2><p>create  beforeCreate：<br>          初始化好了基础属性，基础事件（$on $emit 等），<br>          不包含vm的数据(data)、方法、watch等，所以基本上业务逻辑不需要使用这个钩子，<br>          混合 - 如希望在每个组件中增加一些特定的属性，可以采用这个钩子<br>        created：<br>          创建完成 - 当前这个组件实例，已经实现了数据劫持（数据已经加了get，set），<br>          并把方法、计算属性都挂载到了实例上<br>          但是不能获取到真是的dom元素，不能操作dom<br>Mount   beforeMount：<br>          挂载之前，方法中会调用render方法<br>        mounted：<br>          当前组件挂载完成 - 有了真实的dom，<br>          这个过程中，如果有子组件，会走子组件的生命周期，洋葱模式，<br>          一般把ajax的操作，在这里完成，既能得到vm数据，又有$el方便操作。<br>Update  beforeUpdate：<br>          更新之前 - Vue的更新是diff更新，需要更新的数据在视图中显示，才会触发beforeUpdate<br>        updated：<br>          更新完成，这里不要再更新数据，可能会死循环。<br>Destroy beforeDestroy：<br>          销毁之前 - 可以做事件移除 清空定时器等。<br>        destroyed：<br>          销毁后</p>
<p>触发销毁的方式：- 销毁后会默认移除所有观察者，移除监听事件（watcher.active = false），视图并不会刷新<br>  1-手动移除组件（vm.$destroy()）<br>  2-路由切换</p>
<h2 id="9-Vue-中-ref-是什么？"><a href="#9-Vue-中-ref-是什么？" class="headerlink" title="9 Vue 中 ref 是什么？"></a>9 Vue 中 ref 是什么？</h2><p>组件上是vue组件，dom上指dom元素，for循环出来的是类数组</p>
<h2 id="10-Vue-动画的生命周期？"><a href="#10-Vue-动画的生命周期？" class="headerlink" title="10 Vue 动画的生命周期？"></a>10 Vue 动画的生命周期？</h2><h2 id="11-Vue-如何编写自定义指令？"><a href="#11-Vue-如何编写自定义指令？" class="headerlink" title="11 Vue 如何编写自定义指令？"></a>11 Vue 如何编写自定义指令？</h2><h2 id="12-vuex数据持久化"><a href="#12-vuex数据持久化" class="headerlink" title="12 vuex数据持久化"></a>12 vuex数据持久化</h2><p>用插件（vuex-persists）解决</p>
<p>plugins—plugins就是函数，参数会默认传当前的store实例</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> persists = <span class="function">(<span class="params">store</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// subscribe - 订阅 commit的时候会触发</span></span><br><span class="line">  store.subscribe(<span class="function">(<span class="params">mutation, state</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 这里可以把需要记录的值存到localStotage，然后页面初始化的时候再取值，初始化</span></span><br><span class="line">    <span class="built_in">console</span>.log(mutation);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  plugins: [ persists ],</span><br><span class="line">  modules: &#123;&#125;,</span><br><span class="line">  state: &#123;</span><br><span class="line">    a: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  getters: &#123;&#125;,</span><br><span class="line">  mutations: &#123;&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="13-移动端项目"><a href="#13-移动端项目" class="headerlink" title="13 移动端项目"></a>13 移动端项目</h2><h3 id="单位"><a href="#单位" class="headerlink" title="单位"></a>单位</h3><p>px (不能跟随屏幕大小而改变)<br>em (不好计算)<br>rem (主流)<br>vh vw (主流)</p>
<p>淘宝解决方案：px2rem 插件解决（可以把px 转化成rem，开发中只写px就好）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i lib-flexible --save </span><br><span class="line">npm install --save-dev px2rem-loader</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 main.js中引入</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'lib-flexible/flexible'</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置 vue.config.js</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports= &#123;</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    config.module.rule(<span class="string">'stylus'</span>).test(<span class="regexp">/\.stylus/</span>).oneOf(<span class="string">'vue'</span>)</span><br><span class="line">    .resourceQuery(<span class="regexp">/\?vue/</span>).use(<span class="string">'px2rem'</span>).loader(<span class="string">'px2rem-loader'</span>).options(&#123;<span class="attr">remUnit</span>: <span class="number">75</span>&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="布局-flex"><a href="#布局-flex" class="headerlink" title="布局 flex"></a>布局 flex</h3><ul>
<li>flex-direction  :  row / row-reverse column / column-reverse</li>
<li>flex-wrap : nowrap(默认) / wrap </li>
<li>justify-content : 主轴对齐方式 flex-start flex-end center space-between space-around</li>
<li>align-items : 设置交叉轴的对齐方式 flex-start flex-end center baseline stretch</li>
<li>align-content : 轴线对齐方式 多行对齐方式 flex-start flex-end center stetch space-between space-around</li>
<li>order : 控制元素顺序 默认0 可以设置元素的顺序</li>
<li>flex-grow : 控制元素放大比例</li>
<li>flex-shrink : 控制元素缩小比例</li>
<li>flex-basis : 设置元素固定空间或自动空间的占比</li>
<li>align-self : 重写align-items父属性</li>
</ul>
<h2 id="主流组件库"><a href="#主流组件库" class="headerlink" title="主流组件库"></a>主流组件库</h2><h3 id="pc"><a href="#pc" class="headerlink" title="pc"></a>pc</h3><p>elementUI iview</p>
<h3 id="移动端"><a href="#移动端" class="headerlink" title="移动端"></a>移动端</h3><p>vant mint-ui(官方不维护了) and-vue vube-ui(滴滴出的)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://happychong.github.io/2020/07/22/Vue面试题/" data-id="cl1dl9ze5002dccnumky0wcox" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/面试题/">面试题</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="default-mangoDB" class="article article-type-default" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/11/mangoDB/" class="article-date">
  <time datetime="2020-05-10T16:00:00.000Z" itemprop="datePublished">2020-05-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/mongoDB/">mongoDB</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/11/mangoDB/">mongoDB</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id><a href="#" class="headerlink" title></a></h1><h2 id="1-启动Mongodb服务"><a href="#1-启动Mongodb服务" class="headerlink" title="1 启动Mongodb服务"></a>1 启动Mongodb服务</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装后，进入安装目录的bin目录下，cmd窗口执行如下代码</span></span><br><span class="line"><span class="comment"># ../data/db 是你要存放数据的目录，要先创建出来</span></span><br><span class="line">mongod --dbpath=../data/db</span><br><span class="line"><span class="comment"># 正常的话，会打印出 MongoDB starting : pid=4548 port=27017 dbpath=../data/db 64-bit host=AFOGL-608301248</span></span><br><span class="line"><span class="comment"># pid=4548 : 是进程id， port=27017 ： 是监听的端口号</span></span><br><span class="line"><span class="comment"># 当看到 waiting for connections on port 27017 就代表启动成功了，这个窗口不要关闭哦，关闭了数据库就down掉了，之后就无法连接成功了</span></span><br></pre></td></tr></table></figure>

<h2 id="数据库客户端的基本操作"><a href="#数据库客户端的基本操作" class="headerlink" title="数据库客户端的基本操作"></a>数据库客户端的基本操作</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装目录的bin目录下，cmd窗口执行 mongo 命令就可以开启一个mongo客户端</span></span><br><span class="line">mongo</span><br><span class="line"><span class="comment"># 开启后，就可以在这里执行命令，对数据库进行增删改查了</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看当前数据库</span></span><br><span class="line">db </span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有数据库</span></span><br><span class="line">show dbs;</span><br><span class="line"></span><br><span class="line"><span class="comment"># use - 切换数据库</span></span><br><span class="line">use school;</span><br><span class="line"><span class="comment"># 切换到 school 数据库下，如果当前没有 school 库，需要真正的添加数据后，school 数据库才会创建成功</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># users集合（表）中，插入一个文档（一条数据），users集合没有的话，会自动创建</span></span><br><span class="line">db.users.insert(&#123;name:<span class="string">'zhangsan'</span>, age:10&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找 users集合中的所有文档</span></span><br><span class="line">db.users.find();</span><br></pre></td></tr></table></figure>

<p>可以看到以上命令行的方式操作数据库比较麻烦，下面介绍用node操作数据库</p>
<h2 id="node-操作-mongoDB"><a href="#node-操作-mongoDB" class="headerlink" title="node 操作 mongoDB"></a>node 操作 mongoDB</h2><h3 id="安装依赖包-mongoose"><a href="#安装依赖包-mongoose" class="headerlink" title="安装依赖包 mongoose"></a>安装依赖包 mongoose</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在一个 npm 项目的目录下执行以下命令</span></span><br><span class="line">npm install mongoose -S</span><br></pre></td></tr></table></figure>

<h3 id="使用mongoose-连接数据库"><a href="#使用mongoose-连接数据库" class="headerlink" title="使用mongoose 连接数据库"></a>使用mongoose 连接数据库</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// npm 项目目录下 src/connection.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入 mongoose 模块</span></span><br><span class="line"><span class="keyword">let</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建数据库连接</span></span><br><span class="line"><span class="keyword">let</span> conn = mongoose.createConnection(</span><br><span class="line">  <span class="string">'mongodb://127.0.0.1:27017/cms'</span> <span class="comment">// 默认端口就是27017</span></span><br><span class="line">);</span><br><span class="line">conn.on(<span class="string">'open'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'成功连接到了数据库……………………恭喜你。'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">conn.on(<span class="string">'error'</span>, (err) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'连接数据库失败：'</span>, err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Schema"><a href="#Schema" class="headerlink" title="Schema"></a>Schema</h3><p>Schema 是数据库集合的模型骨架，定义了集合中的字段的名称和类型以及默认值等信息。</p>
<h4 id="Schema-Type"><a href="#Schema-Type" class="headerlink" title="Schema.Type"></a>Schema.Type</h4><ul>
<li>Node 中的基本数据类型都属于 Schema.Type</li>
<li><ul>
<li>String (字符串)</li>
</ul>
</li>
<li><ul>
<li>Date (日期)</li>
</ul>
</li>
<li><ul>
<li>Number(数值)</li>
</ul>
</li>
<li><ul>
<li>Boolean(布尔)</li>
</ul>
</li>
<li><ul>
<li>Buffer(二进制)</li>
</ul>
</li>
<li><ul>
<li>null</li>
</ul>
</li>
<li><ul>
<li>Array(数组)</li>
</ul>
</li>
<li>Mongoose 定义的自己的类型</li>
<li><ul>
<li>ObjectId(主键)</li>
</ul>
</li>
<li><ul>
<li>arrOfString([String])</li>
</ul>
</li>
<li><ul>
<li>arrOfNumber([Number])</li>
</ul>
</li>
<li><ul>
<li>arrOfDate([Date])</li>
</ul>
</li>
<li><ul>
<li>arrOfBugger([Buffer])</li>
</ul>
</li>
<li><ul>
<li>arrOfBoolean([Boolean])</li>
</ul>
</li>
<li><ul>
<li>arrOfObjectId([Schema.types.ObjectId])</li>
</ul>
</li>
<li><ul>
<li>nested({name: String}) 内嵌文档</li>
</ul>
</li>
</ul>
<h4 id="定义-Schema"><a href="#定义-Schema" class="headerlink" title="定义 Schema"></a>定义 Schema</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// npm 项目目录下 src/schema.js</span></span><br><span class="line"><span class="keyword">let</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="keyword">let</span> connection = <span class="built_in">require</span>(<span class="string">'./connection'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Schema定义 (对应集合中的文档)</span></span><br><span class="line"><span class="comment">// Schema 与数据无关，不能直接操作数据库</span></span><br><span class="line"><span class="keyword">let</span> UserSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  name: <span class="built_in">String</span>,</span><br><span class="line">  age: <span class="built_in">Number</span></span><br><span class="line">&#125;, &#123; <span class="attr">collection</span>: <span class="string">'UUser'</span>&#125;); <span class="comment">// 固定集合名为 user，不会自动转小写后转复数</span></span><br></pre></td></tr></table></figure>

<h3 id="Model-模型"><a href="#Model-模型" class="headerlink" title="Model 模型"></a>Model 模型</h3><p>模型是一个总的概念，它代表整个集合，操作对象是整个集合，可以插入文档，查询集合，删除某些数据，批量操作</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// npm 项目目录下 src/schema.js</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// User 是模型的名字，之后可以用这个名字引用模型</span></span><br><span class="line"><span class="keyword">let</span> UserModel = connection.model(<span class="string">'User'</span>, UserSchema);</span><br><span class="line"><span class="comment">// let UserModel2 = connection.model('User');</span></span><br><span class="line"><span class="comment">// connection.model 方法 2个参数--&gt;定义模型   1个参数--&gt;获取模型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Model创建数据</span></span><br><span class="line">UserModel.create(&#123;<span class="attr">name</span>: <span class="string">'zf'</span>, <span class="attr">age</span>: <span class="number">11</span>&#125;, (err, doc) =&gt; &#123;</span><br><span class="line">  <span class="comment">// doc 保存成功后的文档对象</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'err::'</span>, err);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'doc::'</span>, doc);</span><br><span class="line">&#125;);</span><br><span class="line">UserModel.create(&#123;<span class="attr">name</span>: <span class="string">'zf'</span>, <span class="attr">age</span>: <span class="number">10</span>&#125;).then(<span class="function">(<span class="params">doc</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// doc 保存成功后的文档对象</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'doc::'</span>, doc);</span><br><span class="line">&#125;, err =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'err::'</span>, err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="实体"><a href="#实体" class="headerlink" title="实体"></a>实体</h3><p>实体代表一个文档对象，它是单个的概念，只能操作自己</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// npm 项目目录下 src/schema.js</span></span><br><span class="line"><span class="comment">// 。。。 以上代码不再重复写，以下是新增代码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建实体</span></span><br><span class="line"><span class="keyword">let</span> user1 = <span class="keyword">new</span> UserModel(&#123;</span><br><span class="line">  name: <span class="string">'zhf'</span>,</span><br><span class="line">  age: <span class="number">1</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 保存实体</span></span><br><span class="line">user1.save().then(<span class="function"><span class="params">doc</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(doc);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="基础操作-增删改查"><a href="#基础操作-增删改查" class="headerlink" title="基础操作-增删改查"></a>基础操作-增删改查</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// npm 项目目录下 src/baseUse.js</span></span><br><span class="line"><span class="comment">// 基础使用</span></span><br><span class="line"><span class="keyword">let</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="keyword">let</span> connection = <span class="built_in">require</span>(<span class="string">'./connection'</span>);</span><br><span class="line"><span class="keyword">let</span> UserSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  name: <span class="built_in">String</span>,</span><br><span class="line">  age: <span class="built_in">Number</span></span><br><span class="line">&#125;, &#123; <span class="attr">collection</span>: <span class="string">'user'</span>&#125;);</span><br><span class="line"><span class="keyword">let</span> UserModel = connection.model(<span class="string">'User'</span>, UserSchema);</span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 用自执行 async 函数，以便可以用 await 方式写方法</span></span><br><span class="line">  <span class="comment">// *** 下面的增删改查代码，全部写在这里执行</span></span><br><span class="line"></span><br><span class="line">  process.exit(<span class="number">0</span>); <span class="comment">// 结束连接数据库进程</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h4 id="创建数据"><a href="#创建数据" class="headerlink" title="创建数据"></a>创建数据</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一条&#123;name: 'zf1', age: 2&#125;数据</span></span><br><span class="line"><span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.create(&#123;<span class="attr">name</span>: <span class="string">'zf1'</span>, <span class="attr">age</span>: <span class="number">2</span>&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="查找数据"><a href="#查找数据" class="headerlink" title="查找数据"></a>查找数据</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查找所有name为'zf2'的数据</span></span><br><span class="line"><span class="keyword">let</span> docs = <span class="keyword">await</span> UserModel.find(&#123;<span class="attr">name</span>: <span class="string">'zf2'</span>&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 把name为zf1的数据的age变成20</span></span><br><span class="line"><span class="keyword">let</span> updateRes = <span class="keyword">await</span> UserModel.update(&#123;<span class="attr">name</span>: <span class="string">'zf1'</span>&#125;, &#123;<span class="attr">age</span>: <span class="number">20</span>&#125;);</span><br><span class="line"><span class="comment">// UserModel.update（已经被废弃的方法，但仍可以用） 第2个参数是条件，第2个参数是更新后的值</span></span><br><span class="line"><span class="comment">// console.log(updateRes); // &#123; n: 1, nModified: 0, ok: 1 &#125;   n---匹配的条数  nModified---实际发生更新的条数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> updateOneRes = <span class="keyword">await</span> UserModel.updateOne(&#123;<span class="attr">name</span>: <span class="string">'zf1'</span>&#125;, &#123;<span class="attr">age</span>: <span class="number">20</span>&#125;);</span><br><span class="line"><span class="comment">// updateOne - 不管找到多少条数据，只更新第一条数据</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> updateManyRes = <span class="keyword">await</span> UserModel.updateMany(&#123;<span class="attr">name</span>: <span class="string">'zf1'</span>&#125;, &#123;<span class="attr">age</span>: <span class="number">3</span>&#125;);</span><br><span class="line"><span class="comment">// updateMany - 找到多条数据，更新所有数据</span></span><br></pre></td></tr></table></figure>

<h4 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除所有name为zf1的数据</span></span><br><span class="line"><span class="keyword">let</span> removeRes = <span class="keyword">await</span> UserModel.remove(&#123;<span class="attr">name</span>: <span class="string">'zf1'</span>&#125;);</span><br><span class="line"><span class="comment">// remove （已经被废弃的方法，但仍可以用）会删除所有的匹配记录</span></span><br><span class="line"><span class="comment">// console.log(removeRes); // &#123; n: 5, ok: 1, deletedCount: 5 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> deleteOneRes = <span class="keyword">await</span> UserModel.deleteOne(&#123;<span class="attr">name</span>: <span class="string">'zf1'</span>&#125;);</span><br><span class="line"><span class="comment">// deleteOne 只删除匹配到的第一条数据</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> deleteManyRes = <span class="keyword">await</span> UserModel.deleteMany(&#123;<span class="attr">name</span>: <span class="string">'zf3'</span>&#125;);</span><br><span class="line"><span class="comment">// deleteMany 删除所有匹配到的数据</span></span><br><span class="line"><span class="comment">// console.log(deleteManyRes); // &#123; n: 2, ok: 1, deletedCount: 2 &#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="查询详解"><a href="#查询详解" class="headerlink" title="查询详解"></a>查询详解</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// npm 项目目录下 src/search.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询详解</span></span><br><span class="line"><span class="keyword">let</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="keyword">let</span> connection = <span class="built_in">require</span>(<span class="string">'./connection'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> UserSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  name: <span class="built_in">String</span>,</span><br><span class="line">  age: <span class="built_in">Number</span></span><br><span class="line">&#125;, &#123; <span class="attr">collection</span>: <span class="string">'user'</span>&#125;);</span><br><span class="line"><span class="keyword">let</span> UserModel = connection.model(<span class="string">'User'</span>, UserSchema);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 用自执行 async 函数</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 先准备数据库数据</span></span><br><span class="line">  <span class="comment">// let users = [];</span></span><br><span class="line">  <span class="comment">// for (let i = 1; i &lt;= 10; i++) &#123;</span></span><br><span class="line">  <span class="comment">//   users.push(&#123;</span></span><br><span class="line">  <span class="comment">//     name: `zf$&#123;i&#125;`,</span></span><br><span class="line">  <span class="comment">//     age: i</span></span><br><span class="line">  <span class="comment">//   &#125;)</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  <span class="comment">// await UserModel.create(users);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 按属性过滤</span></span><br><span class="line">  <span class="keyword">let</span> findRes = <span class="keyword">await</span> UserModel.find(&#123;<span class="attr">name</span>: <span class="string">'zf1'</span>&#125;);</span><br><span class="line">  <span class="comment">// 查找1条</span></span><br><span class="line">  <span class="keyword">let</span> findOneRes = <span class="keyword">await</span> UserModel.findOne(&#123;&#125;);</span><br><span class="line">  <span class="comment">// 通过Id查找</span></span><br><span class="line">  <span class="keyword">let</span> findByIdRes = <span class="keyword">await</span> UserModel.findById(<span class="string">'5f115ecc38c3e0609c1da4a5'</span>);</span><br><span class="line">  <span class="comment">// 大于:      gt           great than</span></span><br><span class="line">  <span class="keyword">let</span> gtRes = <span class="keyword">await</span> UserModel.find(&#123;<span class="attr">age</span>: &#123;<span class="attr">$gt</span>: <span class="number">5</span>&#125;&#125;);</span><br><span class="line">  <span class="comment">// 小于:      lt           less than</span></span><br><span class="line">  <span class="keyword">let</span> ltRes = <span class="keyword">await</span> UserModel.find(&#123;<span class="attr">age</span>: &#123;<span class="attr">$lt</span>: <span class="number">5</span>&#125;&#125;);</span><br><span class="line">  <span class="comment">// 大于等于:   gte          great than or equal</span></span><br><span class="line">  <span class="keyword">let</span> geRes = <span class="keyword">await</span> UserModel.find(&#123;<span class="attr">age</span>: &#123;<span class="attr">$gte</span>: <span class="number">5</span>&#125;&#125;);</span><br><span class="line">  <span class="comment">// 小于等于:   le          less  than or equal</span></span><br><span class="line">  <span class="keyword">let</span> leRes = <span class="keyword">await</span> UserModel.find(&#123;<span class="attr">age</span>: &#123;<span class="attr">$lte</span>: <span class="number">5</span>&#125;&#125;);</span><br><span class="line">  <span class="comment">// 不等于:     ne          not equal</span></span><br><span class="line">  <span class="keyword">let</span> neRes = <span class="keyword">await</span> UserModel.find(&#123;<span class="attr">age</span>: &#123;<span class="attr">$ne</span>: <span class="number">5</span>&#125;&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 包含 in</span></span><br><span class="line">  <span class="keyword">let</span> inStrRes = <span class="keyword">await</span> UserModel.find(&#123;<span class="attr">age</span>: &#123;<span class="attr">$in</span>: <span class="number">6</span>&#125;&#125;);</span><br><span class="line">  <span class="comment">// 返回 age === 6 的数据</span></span><br><span class="line">  <span class="keyword">let</span> inArrRes = <span class="keyword">await</span> UserModel.find(&#123;<span class="attr">age</span>: &#123;<span class="attr">$in</span>: [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]&#125;&#125;);</span><br><span class="line">  <span class="comment">// 返回 age === 5 || age === 6 || age === 7 的数据</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// or 或</span></span><br><span class="line">  <span class="keyword">let</span> orArrRes1 = <span class="keyword">await</span> UserModel.find(&#123;<span class="attr">$or</span>: [&#123;<span class="attr">name</span>: <span class="string">'zf1'</span>&#125;, &#123;<span class="attr">age</span>: <span class="number">7</span>&#125;]&#125;);</span><br><span class="line">  <span class="comment">// name === zf1 || age === 7 的数据</span></span><br><span class="line">  <span class="keyword">let</span> orArrRes2 = <span class="keyword">await</span> UserModel.find(&#123;<span class="attr">$or</span>: [</span><br><span class="line">    &#123;<span class="attr">age</span>: &#123;<span class="attr">$lt</span>: <span class="number">3</span>&#125;&#125;,</span><br><span class="line">    &#123;<span class="attr">age</span>: &#123;<span class="attr">$gt</span>: <span class="number">7</span>&#125;&#125;</span><br><span class="line">  ]&#125;);</span><br><span class="line">  <span class="comment">// age &lt; 3 || age &gt; 7 的数据</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 分页查询</span></span><br><span class="line">  <span class="keyword">let</span> pageSize = <span class="number">3</span>; <span class="comment">// 每页3条</span></span><br><span class="line">  <span class="keyword">let</span> pageNum = <span class="number">2</span>; <span class="comment">// 查询第2页</span></span><br><span class="line">  <span class="keyword">let</span> pageRes = <span class="keyword">await</span> UserModel.find(&#123;&#125;).sort(&#123;<span class="attr">age</span>: <span class="number">1</span>&#125;).skip((pageNum - <span class="number">1</span>) * pageSize).limit(pageSize);</span><br><span class="line">  <span class="comment">// sort(&#123;age: 1&#125;) --&gt; 1：升序   -1：降序</span></span><br><span class="line">  <span class="comment">// skip(3) ---&gt; 跳过3</span></span><br><span class="line">  <span class="comment">// limit() ---&gt; 限定返回的最大数据数</span></span><br><span class="line"></span><br><span class="line">  process.exit(<span class="number">0</span>); <span class="comment">// 结束连接数据库进程</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h3 id="populate-主表-amp-附表"><a href="#populate-主表-amp-附表" class="headerlink" title="populate 主表 &amp; 附表"></a>populate 主表 &amp; 附表</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// npm 项目目录下 src/populate.js</span></span><br><span class="line"><span class="comment">// 主键 &amp; 外键</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> mongoose = <span class="built_in">require</span>(<span class="string">'mongoose'</span>);</span><br><span class="line"><span class="keyword">let</span> connection = <span class="built_in">require</span>(<span class="string">'./connection'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// User's Schema and Model</span></span><br><span class="line"><span class="keyword">let</span> UserSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  name: <span class="built_in">String</span>,</span><br><span class="line">  age: <span class="built_in">Number</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">let</span> UserModel = connection.model(<span class="string">'User'</span>, UserSchema);</span><br><span class="line"><span class="comment">// Score's Schema and Model</span></span><br><span class="line"><span class="keyword">let</span> ScoreSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  <span class="comment">// uid 是一个外键 类型是ObjectId，引用的是User模型</span></span><br><span class="line">  uid: &#123;<span class="attr">type</span>: mongoose.Schema.Types.ObjectId, <span class="attr">ref</span>: <span class="string">'User'</span>&#125;,</span><br><span class="line">  grade: <span class="built_in">Number</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">let</span> ScoreModel = connection.model(<span class="string">'Score'</span>, ScoreSchema);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 用自执行 async 函数</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 保存数据 - 先写主表，再把主表的主键赋值给附表的外键</span></span><br><span class="line">  <span class="comment">// let name = await UserModel.create(&#123;name: 'Tom'&#125;);</span></span><br><span class="line">  <span class="comment">// let score = await ScoreModel.create(&#123;uid: name._id, grade: 88&#125;);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通过附表的uid查主表的数据</span></span><br><span class="line">  <span class="comment">// 方法1：查2次，麻烦</span></span><br><span class="line">  <span class="keyword">let</span> scoreId = <span class="string">'5f117511c587c05dbc2971fa'</span>;</span><br><span class="line">  <span class="keyword">let</span> scoreRes = <span class="keyword">await</span> ScoreModel.findById(scoreId);</span><br><span class="line">  <span class="keyword">let</span> userRes = <span class="keyword">await</span> UserModel.findById(scoreRes.uid);</span><br><span class="line">  <span class="comment">// 方法2：</span></span><br><span class="line">  <span class="keyword">let</span> userRes2 = <span class="keyword">await</span> ScoreModel.findById(scoreId).populate(<span class="string">'uid'</span>);</span><br><span class="line">  <span class="comment">// populate 把外键id变成一个对象，得到以下数据</span></span><br><span class="line">  <span class="comment">// &#123;</span></span><br><span class="line">  <span class="comment">//   _id: 5f117511c587c05dbc2971fa,</span></span><br><span class="line">  <span class="comment">//   uid: &#123; _id: 5f117511c587c05dbc2971f9, name: 'Tom', __v: 0 &#125;,</span></span><br><span class="line">  <span class="comment">//   grade: 88,</span></span><br><span class="line">  <span class="comment">//   __v: 0</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  process.exit(<span class="number">0</span>); <span class="comment">// 结束连接数据库进程</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<ul>
<li><a href="https://github.com/happychong/my_first_flutter_app" target="_blank" rel="noopener">my_first_flutter_app</a></li>
<li><a href="https://github.com/happychong/film_flutter_app" target="_blank" rel="noopener">film_flutter_app</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://happychong.github.io/2020/05/11/mangoDB/" data-id="cl1dl9zdw0026ccnuasrdl6dc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mongoDB/">mongoDB</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="default-dart" class="article article-type-default" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/27/dart/" class="article-date">
  <time datetime="2020-04-26T16:00:00.000Z" itemprop="datePublished">2020-04-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Dart/">Dart</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/04/27/dart/">Dart 入门</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id><a href="#" class="headerlink" title></a></h1><h2 id="1-概述"><a href="#1-概述" class="headerlink" title="1 概述"></a>1 概述</h2><p>这个学习笔记写的很水，只为了初步了解flutter，所以语言方面没有深入学习，只学了基础的。</p>
<p>学习 Dart ，主要为了学习 flutter，代码太多，具体不贴了。链接如下</p>
<ul>
<li><a href="https://github.com/happychong/my_first_flutter_app" target="_blank" rel="noopener">my_first_flutter_app</a></li>
<li><a href="https://github.com/happychong/film_flutter_app" target="_blank" rel="noopener">film_flutter_app</a></li>
</ul>
<ul>
<li>1.强类型编程语言,Dart之下一切皆对象</li>
<li>2.Dart 目前可用于全平台开发</li>
<li>3.Dart 是谷歌发布的面向对象的开源编程语言</li>
</ul>
<h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><ul>
<li>Web开发</li>
<li>扩平台移动应用开发（Flutter）</li>
<li>脚本或服务端开发</li>
</ul>
<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// var 定义变量不要求数据类型，表示泛型，但是对数据类型自动识别，</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line">print(a);</span><br><span class="line"><span class="comment">// var a = 10;  重复定义一个变量名，会报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义常量：</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// final</span></span><br><span class="line"><span class="comment">// 1：定义与赋值一次完成，也就是定义的时候必须赋值</span></span><br><span class="line"><span class="comment">// 2：重新赋值会报错，不能重新复制</span></span><br><span class="line"><span class="comment">// 3：即可以是编译器常量，也可以是运行结果</span></span><br><span class="line">final b = <span class="number">10</span>;</span><br><span class="line"><span class="comment">// b = 3; // 报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const </span></span><br><span class="line"><span class="comment">// 1：定义与赋值一次完成，也就是定义的时候必须赋值</span></span><br><span class="line"><span class="comment">// 2：重新赋值会报错，不能重新复制</span></span><br><span class="line"><span class="comment">// 3：定义的是编译器的常量，不能是运行结果</span></span><br></pre></td></tr></table></figure>

<h2 id="flutter"><a href="#flutter" class="headerlink" title="flutter"></a>flutter</h2><p>statelessWidget - 无状态组件<br>StatefulWidget - 有状态组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一个flutter应用，最基础的</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入一个UI组件库</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"><span class="comment">// main 函数是入口函数   runApp 是系统提供的方法，就是执行渲染</span></span><br><span class="line"><span class="keyword">void</span> main() =&gt; runApp(MyApp());</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="comment">// override 意思就是覆盖   Widget 是组件类型，规定我们build函数的返回值类型 ，必须是一个组件</span></span><br><span class="line">  <span class="comment">// 每一个静态组件都需要一个build函数，用来做组件的渲染</span></span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">// 每个项目最外成必须被MaterialApp包裹，里面有一些UI组件，包含了移动端页面渲染的一些相关规范</span></span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      <span class="comment">// title 每个页面都有一个title，不显示在页面上</span></span><br><span class="line">      title: <span class="string">'Flutter Demo'</span>,</span><br><span class="line">      <span class="comment">// theme 设置当前项目的默认颜色</span></span><br><span class="line">      theme: ThemeData(</span><br><span class="line">        primarySwatch: Colors.blue,</span><br><span class="line">      ),</span><br><span class="line">      home: HomePage(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomePage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  @override</span><br><span class="line">  _HomePageState createState() =&gt; _HomePageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_HomePageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">HomePage</span>&gt; </span>&#123;</span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      <span class="comment">// appBar 头部导航组件</span></span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        <span class="comment">// title: Text(widget.title + ' 000'),</span></span><br><span class="line">        title: Text(<span class="string">'new Title'</span>)</span><br><span class="line">      ),</span><br><span class="line">      body: Center(</span><br><span class="line">        child: Text(<span class="string">'hello world'</span>)</span><br><span class="line">      )</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://happychong.github.io/2020/04/27/dart/" data-id="cl1dl9zdt0023ccnukiyp4oad" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Dart/">Dart</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/03/29/2018-1-11-HEXO-hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2022/03/29/2020-3-20-webpack原理/">webpack 原理与实现</a>
          </li>
        
          <li>
            <a href="/2022/03/29/2020-3-25-webpack-loader原理/">webpack - loader 原理与实现</a>
          </li>
        
          <li>
            <a href="/2021/08/05/typescript/">typescript</a>
          </li>
        
          <li>
            <a href="/2021/08/05/面试题总结（非Vue）/">2021-08-05-面试题总结（非Vue）</a>
          </li>
        
          <li>
            <a href="/2021/03/22/git bash arrow 不能选择解决方案(windows)/">git bash arrow 不能选择解决方案(windows)</a>
          </li>
        
          <li>
            <a href="/2020/07/22/Vue基础/">Vue 基础知识</a>
          </li>
        
          <li>
            <a href="/2020/07/22/Vue面试题/">Vue 面试题</a>
          </li>
        
          <li>
            <a href="/2020/05/11/mangoDB/">mongoDB</a>
          </li>
        
          <li>
            <a href="/2020/04/27/dart/">Dart 入门</a>
          </li>
        
          <li>
            <a href="/2020/04/23/ast/">ast（语法树）</a>
          </li>
        
          <li>
            <a href="/2020/04/21/node进程（pm2）/">Node 的 进程(pm2)</a>
          </li>
        
          <li>
            <a href="/2020/04/14/node进程（process）/">Node 的 进程 (process)</a>
          </li>
        
          <li>
            <a href="/2020/03/30/webpack源码编译流程/">webpack - 源码编译流程</a>
          </li>
        
          <li>
            <a href="/2019/12/20/webpack优化/">webpack 4.0 + 笔记(优化)</a>
          </li>
        
          <li>
            <a href="/2019/12/16/webpack基础配置/">webpack 4.0+ 笔记(基础配置)</a>
          </li>
        
          <li>
            <a href="/2019/11/19/HTTP基础/">HTTP基础扫盲</a>
          </li>
        
          <li>
            <a href="/2019/11/07/node深度删除目录及目录里的内容-fs删除扩展/">Node - 深度（完全）删除目录及目录里的内容 - 扩展</a>
          </li>
        
          <li>
            <a href="/2019/11/01/JS中，0.1+0.2＞0.3为什么？/">0.1+0.2 &gt; 0.3 Why???</a>
          </li>
        
          <li>
            <a href="/2019/11/01/Node中文件的读写模块---FS/">Node -文件读写模块--- fs</a>
          </li>
        
          <li>
            <a href="/2019/10/30/Node---buffer/">Node --- buffer</a>
          </li>
        
          <li>
            <a href="/2019/10/24/npm命令与配置解析/">npm 命令与配置解析</a>
          </li>
        
          <li>
            <a href="/2019/10/16/Node中的事件循环（event loop）/">Node中的事件轮询（event loop）</a>
          </li>
        
          <li>
            <a href="/2019/10/14/node核心模块-简述/">Node核心模块 - 简述</a>
          </li>
        
          <li>
            <a href="/2019/10/14/node模块加载原理/">Node模块加载原理</a>
          </li>
        
          <li>
            <a href="/2019/10/14/多线程与单线程服务/">单线程与多线程的基本概念</a>
          </li>
        
          <li>
            <a href="/2019/10/12/node基本概念扫盲/">Node基本概念扫盲</a>
          </li>
        
          <li>
            <a href="/2019/10/12/浏览器中js的事件循环（event loop）/">浏览器中javascript的事件循环（event loop）</a>
          </li>
        
          <li>
            <a href="/2019/10/05/vue nextTick原理/">vue nextTick原理</a>
          </li>
        
          <li>
            <a href="/2019/09/05/es6+---类的修饰/">es6+---类的修饰</a>
          </li>
        
          <li>
            <a href="/2019/09/03/es+---class用法笔记 /">es6、7-类的定义</a>
          </li>
        
          <li>
            <a href="/2018/08/08/vue 强制更新试图的方法/">vue 强制更新试图 的方法</a>
          </li>
        
          <li>
            <a href="/2016/05/19/宋晓丹的个人简历/">宋晓丹的个人简历</a>
          </li>
        
          <li>
            <a href="/2016/05/11/windows下，ATOM常用编辑器快捷键/">ATOM常用快捷键</a>
          </li>
        
          <li>
            <a href="/2016/05/05/Git命令/">Git常用命令</a>
          </li>
        
          <li>
            <a href="/2016/05/05/基本shell命令/">基本SHELL命令使用</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Dart/">Dart</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Node/">Node</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Vue/">Vue</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/es6/">es6</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mongoDB/">mongoDB</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vue/">vue</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/个人/">个人</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/周边/">周边</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dart/">Dart</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EventLoop/">EventLoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node/">Node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue/">Vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ast/">ast</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/buffer/">buffer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/class/">class</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/core/">core</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/event-loop/">event loop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/events/">events</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fs/">fs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/happyChong/">happyChong</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/loader/">loader</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/module/">module</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongoDB/">mongoDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nextTick/">nextTick</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/path/">path</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pm2/">pm2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/process/">process</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/typescript/">typescript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/util/">util</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vm/">vm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/">webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/单线程/">单线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/多线程/">多线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/面试题/">面试题</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Dart/" style="font-size: 10px;">Dart</a> <a href="/tags/EventLoop/" style="font-size: 13.33px;">EventLoop</a> <a href="/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/tags/Node/" style="font-size: 10px;">Node</a> <a href="/tags/Vue/" style="font-size: 10px;">Vue</a> <a href="/tags/ast/" style="font-size: 10px;">ast</a> <a href="/tags/buffer/" style="font-size: 10px;">buffer</a> <a href="/tags/class/" style="font-size: 13.33px;">class</a> <a href="/tags/core/" style="font-size: 10px;">core</a> <a href="/tags/event-loop/" style="font-size: 13.33px;">event loop</a> <a href="/tags/events/" style="font-size: 10px;">events</a> <a href="/tags/fs/" style="font-size: 16.67px;">fs</a> <a href="/tags/git/" style="font-size: 16.67px;">git</a> <a href="/tags/happyChong/" style="font-size: 10px;">happyChong</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/javascript/" style="font-size: 10px;">javascript</a> <a href="/tags/loader/" style="font-size: 10px;">loader</a> <a href="/tags/module/" style="font-size: 10px;">module</a> <a href="/tags/mongoDB/" style="font-size: 10px;">mongoDB</a> <a href="/tags/nextTick/" style="font-size: 10px;">nextTick</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/path/" style="font-size: 10px;">path</a> <a href="/tags/pm2/" style="font-size: 10px;">pm2</a> <a href="/tags/process/" style="font-size: 10px;">process</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/typescript/" style="font-size: 10px;">typescript</a> <a href="/tags/util/" style="font-size: 10px;">util</a> <a href="/tags/vm/" style="font-size: 10px;">vm</a> <a href="/tags/vue/" style="font-size: 10px;">vue</a> <a href="/tags/webpack/" style="font-size: 20px;">webpack</a> <a href="/tags/单线程/" style="font-size: 10px;">单线程</a> <a href="/tags/多线程/" style="font-size: 10px;">多线程</a> <a href="/tags/面试题/" style="font-size: 13.33px;">面试题</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 happyChong<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>